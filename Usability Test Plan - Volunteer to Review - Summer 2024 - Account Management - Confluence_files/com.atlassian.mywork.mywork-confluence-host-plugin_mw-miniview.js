WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/util/miniview-util.js' */
var MW=MW||{$:jQuery};MW.Cookie=function(){return{name:"mywork.tab.tasks",save:function(f){this.setCookie(this.name,f,7)},load:function(){return"true"==this.getCookie(this.name)},setCookie:function(f,d,c){var a="";c&&(a=new Date,a.setTime(a.getTime()+864E5*c),a="; expires\x3d"+a.toGMTString());document.cookie=f+"\x3d"+d+a+"; path\x3d/"},getCookie:function(f){f+="\x3d";for(var d=document.cookie.split("; "),c=0;c<d.length;c++)if(0===d[c].indexOf(f))return d[c].substring(f.length,d[c].length);return null}}}();
MW.Slide={FROM_RIGHT:"from-right",FROM_LEFT:"from-left"};
MW.CardTransitions=function(f){var d=f.globalEvents;return{showCard:function(c,a,b,h){b=b||300;if(a===MW.Slide.FROM_RIGHT){var k="right";var e="left"}else a===MW.Slide.FROM_LEFT?(k="left",e="right"):k=e="";var g=MW.$(".showing");MW.$(".transition-finished").removeClass("transition-finished");setTimeout(function(){d.trigger("blockKeyboardShortcut");c.addClass("showing");c.show("slide",{direction:k},b,function(){d.trigger("unblockKeyboardShortcut");c.addClass("transition-finished")});0<g.length&&g[0]==
c[0]?h&&h():(g.removeClass("showing"),g.hide("slide",{direction:e},b,function(){d.trigger("cleanupNestedCard");h&&h()}))})}}};
MW.$(function(f){(function(d,c){MW.$.effects.slide=function(a){return this.queue(function(){var b=MW.$(this),h=["position","top","bottom","left","right"],k=MW.$.effects.setMode(b,a.options.mode||"show"),e=a.options.direction||"left";MW.$.effects.save(b,h);b.show();MW.$.effects.createWrapper(b).css({overflow:"hidden"});var g="up"==e||"down"==e?"top":"left";e="up"==e||"left"==e?"pos":"neg";var l=a.options.distance||("top"==g?b.outerHeight({margin:!0}):b.outerWidth({margin:!0}));"show"==k&&b.css(g,"pos"==
e?isNaN(l)?"-"+l:-l:l);var m={};m[g]=("show"==k?"pos"==e?"+\x3d":"-\x3d":"pos"==e?"-\x3d":"+\x3d")+l;b.animate(m,{queue:!1,duration:a.duration,easing:a.options.easing,complete:function(){"hide"==k&&b.hide();MW.$.effects.restore(b,h);d.effects.removeWrapper(b);a.callback&&a.callback.apply(this,arguments);b.dequeue()}})})}})(f)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/util/common-util.js' */
MW.format=function(a){var c=/^((?:(?:[^']*'){2})*?[^']*?)\{(\d+)\}/,b=/'(?!')/g;MW.format=function(d){for(var f=arguments,g="",e=d.match(c);e;)d=d.substring(e[0].length),g+=e[1].replace(b,"")+(f.length>++e[2]?f[e[2]]:""),e=d.match(c);return g+d.replace(b,"")};return MW.format.apply(MW,arguments)};MW.formatString=function(a,c){return a.replace(/\{\{|\}\}|\{(\w+)\}/g,function(b,d){return"{{"==b?"{":"}}"==b?"}":c[d]})};MW.getParameterByNameFromHash=function(a){return MW.getParameterByName(a,window.location.hash)};
MW.getParameterByName=function(a,c){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");a=(new RegExp("[\\?\\#\x26]"+a+"\x3d([^\x26#]*)")).exec(c||window.location.search);return null===a?"":decodeURIComponent(a[1].replace(/\+/g," "))};MW.setRequestTime=function(a){MW.timeDifference=(new Date).getTime()-parseInt(a,10)};
MW.getPrettyTime=function(a){a=new Date(a+MW.timeDifference);var c=new Date,b=c-a;return a>=c?"right now":6E4>b?"just a moment ago":12E4>b?"a minute ago":3E6>b?AJS.format("{0} minutes ago",Math.floor(b/6E4)):54E5>b?"about an hour ago":72E5>b?AJS.format("about {0} hours ago",Math.ceil(b/36E5)):864E5>b?AJS.format("about {0} hours ago",Math.floor(b/36E5)):1728E5>
b?"Last 48 hours":AJS.format("{0} days ago",Math.floor(b/864E5))};MW.escapeHTML=function(a){return a?a.replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;").replace(/>/g,"\x26gt;"):a};MW.pick=function(a){var c={};_.each(_.flatten(Array.prototype.slice.call(arguments,1)),function(b){b in a&&(c[b]=a[b])});return c};
MW.Deferred=function(){var a=MW.$.Deferred();return{done:_.bind(a.done,a),isResolved:function(){return"resolved"===a.state()},resolveOnSuccess:function(c){return _.extend({},c,{success:function(){c&&c.success&&c.success();a.resolve()}})}}};MW.makeTextAreaExpandable=function(a,c){var b=a.find(".expandingArea textarea"),d=a.find(".expandingArea span");d.text(b.val());b.bind("input",function(){d.text(b.val());c&&c()});a.find(".expandingArea").addClass("active")};
MW.getBaseUrl=function(){return window.location.href.split("/",3).join("/")+MW.contextPath};MW.createMiniviewCallback=function(a,c){var b=document.createElement("a");b.href=a;a=b.search;0===a.length?a="?show-miniview":/[?&]show-miniview/.test(a)||(a+="\x26show-miniview");c&&(a+="\x3d"+encodeURIComponent(c));return b.pathname+a+b.hash};
MW.createCallback=function(a,c){if("chrome"!==MW.App.parseView())return"mobile"===MW.App.parseView()?a+"/plugins/servlet/mobile?#mywork/notification":MW.parentConfig.parentUrl?MW.createMiniviewCallback(MW.parentConfig.parentUrl,c):a+"/plugins/servlet/notifications-miniview/notification"};MW.appendCallback=function(a,c){a=0>a.indexOf("%3F")?"?":"\x26";return encodeURIComponent(a+"callback\x3d"+encodeURIComponent(c))};
MW.onJsonMessage=function(a){function c(b){if(b.origin===location.protocol+"//"+location.host){var d=JSON.parse(b.data);a(d,b)}}window.addEventListener?window.addEventListener("message",c,!1):window.attachEvent("onmessage",c)};MW.$(function(){MW.$.fn.serializeObject=function(){var a={},c=this.serializeArray();_.each(c,function(b){void 0!==a[b.name]?(a[b.name].push||(a[b.name]=[a[b.name]]),a[b.name].push(b.value||"")):a[b.name]=b.value||""});return a}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/lib/backbone-min.js' */
// Backbone.js 0.9.2

// (c) 2010-2012 Jeremy Ashkenas, DocumentCloud Inc.
// Backbone may be freely distributed under the MIT license.
// For all details and documentation:
// http://backbonejs.org
(function(){var l=this,y=l.Backbone,z=Array.prototype.slice,A=Array.prototype.splice,g;g="undefined"!==typeof exports?exports:l.Backbone={};g.VERSION="0.9.2";var f=l._;!f&&"undefined"!==typeof require&&(f=require("underscore"));var i=l.jQuery||l.Zepto||l.ender;g.setDomLibrary=function(a){i=a};g.noConflict=function(){l.Backbone=y;return this};g.emulateHTTP=!1;g.emulateJSON=!1;var p=/\s+/,k=g.Events={on:function(a,b,c){var d,e,f,g,j;if(!b)return this;a=a.split(p);for(d=this._callbacks||(this._callbacks=
{});e=a.shift();)f=(j=d[e])?j.tail:{},f.next=g={},f.context=c,f.callback=b,d[e]={tail:g,next:j?j.next:f};return this},off:function(a,b,c){var d,e,h,g,j,q;if(e=this._callbacks){if(!a&&!b&&!c)return delete this._callbacks,this;for(a=a?a.split(p):f.keys(e);d=a.shift();)if(h=e[d],delete e[d],h&&(b||c))for(g=h.tail;(h=h.next)!==g;)if(j=h.callback,q=h.context,b&&j!==b||c&&q!==c)this.on(d,j,q);return this}},trigger:function(a){var b,c,d,e,f,g;if(!(d=this._callbacks))return this;f=d.all;a=a.split(p);for(g=
z.call(arguments,1);b=a.shift();){if(c=d[b])for(e=c.tail;(c=c.next)!==e;)c.callback.apply(c.context||this,g);if(c=f){e=c.tail;for(b=[b].concat(g);(c=c.next)!==e;)c.callback.apply(c.context||this,b)}}return this}};k.bind=k.on;k.unbind=k.off;var o=g.Model=function(a,b){var c;a||(a={});b&&b.parse&&(a=this.parse(a));if(c=n(this,"defaults"))a=f.extend({},c,a);b&&b.collection&&(this.collection=b.collection);this.attributes={};this._escapedAttributes={};this.cid=f.uniqueId("c");this.changed={};this._silent=
{};this._pending={};this.set(a,{silent:!0});this.changed={};this._silent={};this._pending={};this._previousAttributes=f.clone(this.attributes);this.initialize.apply(this,arguments)};f.extend(o.prototype,k,{changed:null,_silent:null,_pending:null,idAttribute:"id",initialize:function(){},toJSON:function(){return f.clone(this.attributes)},get:function(a){return this.attributes[a]},escape:function(a){var b;if(b=this._escapedAttributes[a])return b;b=this.get(a);return this._escapedAttributes[a]=f.escape(null==
b?"":""+b)},has:function(a){return null!=this.get(a)},set:function(a,b,c){var d,e;f.isObject(a)||null==a?(d=a,c=b):(d={},d[a]=b);c||(c={});if(!d)return this;d instanceof o&&(d=d.attributes);if(c.unset)for(e in d)d[e]=void 0;if(!this._validate(d,c))return!1;this.idAttribute in d&&(this.id=d[this.idAttribute]);var b=c.changes={},h=this.attributes,g=this._escapedAttributes,j=this._previousAttributes||{};for(e in d){a=d[e];if(!f.isEqual(h[e],a)||c.unset&&f.has(h,e))delete g[e],(c.silent?this._silent:
b)[e]=!0;c.unset?delete h[e]:h[e]=a;!f.isEqual(j[e],a)||f.has(h,e)!=f.has(j,e)?(this.changed[e]=a,c.silent||(this._pending[e]=!0)):(delete this.changed[e],delete this._pending[e])}c.silent||this.change(c);return this},unset:function(a,b){(b||(b={})).unset=!0;return this.set(a,null,b)},clear:function(a){(a||(a={})).unset=!0;return this.set(f.clone(this.attributes),a)},fetch:function(a){var a=a?f.clone(a):{},b=this,c=a.success;a.success=function(d,e,f){if(!b.set(b.parse(d,f),a))return!1;c&&c(b,d)};
a.error=g.wrapError(a.error,b,a);return(this.sync||g.sync).call(this,"read",this,a)},save:function(a,b,c){var d,e;f.isObject(a)||null==a?(d=a,c=b):(d={},d[a]=b);c=c?f.clone(c):{};if(c.wait){if(!this._validate(d,c))return!1;e=f.clone(this.attributes)}a=f.extend({},c,{silent:!0});if(d&&!this.set(d,c.wait?a:c))return!1;var h=this,i=c.success;c.success=function(a,b,e){b=h.parse(a,e);if(c.wait){delete c.wait;b=f.extend(d||{},b)}if(!h.set(b,c))return false;i?i(h,a):h.trigger("sync",h,a,c)};c.error=g.wrapError(c.error,
h,c);b=this.isNew()?"create":"update";b=(this.sync||g.sync).call(this,b,this,c);c.wait&&this.set(e,a);return b},destroy:function(a){var a=a?f.clone(a):{},b=this,c=a.success,d=function(){b.trigger("destroy",b,b.collection,a)};if(this.isNew())return d(),!1;a.success=function(e){a.wait&&d();c?c(b,e):b.trigger("sync",b,e,a)};a.error=g.wrapError(a.error,b,a);var e=(this.sync||g.sync).call(this,"delete",this,a);a.wait||d();return e},url:function(){var a=n(this,"urlRoot")||n(this.collection,"url")||t();
return this.isNew()?a:a+("/"==a.charAt(a.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(a){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},change:function(a){a||(a={});var b=this._changing;this._changing=!0;for(var c in this._silent)this._pending[c]=!0;var d=f.extend({},a.changes,this._silent);this._silent={};for(c in d)this.trigger("change:"+c,this,this.get(c),a);if(b)return this;for(;!f.isEmpty(this._pending);){this._pending=
{};this.trigger("change",this,a);for(c in this.changed)!this._pending[c]&&!this._silent[c]&&delete this.changed[c];this._previousAttributes=f.clone(this.attributes)}this._changing=!1;return this},hasChanged:function(a){return!arguments.length?!f.isEmpty(this.changed):f.has(this.changed,a)},changedAttributes:function(a){if(!a)return this.hasChanged()?f.clone(this.changed):!1;var b,c=!1,d=this._previousAttributes,e;for(e in a)if(!f.isEqual(d[e],b=a[e]))(c||(c={}))[e]=b;return c},previous:function(a){return!arguments.length||
!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return f.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(a,b){if(b.silent||!this.validate)return!0;var a=f.extend({},this.attributes,a),c=this.validate(a,b);if(!c)return!0;b&&b.error?b.error(this,c,b):this.trigger("error",this,c,b);return!1}});var r=g.Collection=function(a,b){b||(b={});b.model&&(this.model=b.model);b.comparator&&(this.comparator=b.comparator);
this._reset();this.initialize.apply(this,arguments);a&&this.reset(a,{silent:!0,parse:b.parse})};f.extend(r.prototype,k,{model:o,initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},add:function(a,b){var c,d,e,g,i,j={},k={},l=[];b||(b={});a=f.isArray(a)?a.slice():[a];c=0;for(d=a.length;c<d;c++){if(!(e=a[c]=this._prepareModel(a[c],b)))throw Error("Can't add an invalid model to a collection");g=e.cid;i=e.id;j[g]||this._byCid[g]||null!=i&&(k[i]||this._byId[i])?
l.push(c):j[g]=k[i]=e}for(c=l.length;c--;)a.splice(l[c],1);c=0;for(d=a.length;c<d;c++)(e=a[c]).on("all",this._onModelEvent,this),this._byCid[e.cid]=e,null!=e.id&&(this._byId[e.id]=e);this.length+=d;A.apply(this.models,[null!=b.at?b.at:this.models.length,0].concat(a));this.comparator&&this.sort({silent:!0});if(b.silent)return this;c=0;for(d=this.models.length;c<d;c++)if(j[(e=this.models[c]).cid])b.index=c,e.trigger("add",e,this,b);return this},remove:function(a,b){var c,d,e,g;b||(b={});a=f.isArray(a)?
a.slice():[a];c=0;for(d=a.length;c<d;c++)if(g=this.getByCid(a[c])||this.get(a[c]))delete this._byId[g.id],delete this._byCid[g.cid],e=this.indexOf(g),this.models.splice(e,1),this.length--,b.silent||(b.index=e,g.trigger("remove",g,this,b)),this._removeReference(g);return this},push:function(a,b){a=this._prepareModel(a,b);this.add(a,b);return a},pop:function(a){var b=this.at(this.length-1);this.remove(b,a);return b},unshift:function(a,b){a=this._prepareModel(a,b);this.add(a,f.extend({at:0},b));return a},
shift:function(a){var b=this.at(0);this.remove(b,a);return b},get:function(a){return null==a?void 0:this._byId[null!=a.id?a.id:a]},getByCid:function(a){return a&&this._byCid[a.cid||a]},at:function(a){return this.models[a]},where:function(a){return f.isEmpty(a)?[]:this.filter(function(b){for(var c in a)if(a[c]!==b.get(c))return!1;return!0})},sort:function(a){a||(a={});if(!this.comparator)throw Error("Cannot sort a set without a comparator");var b=f.bind(this.comparator,this);1==this.comparator.length?
this.models=this.sortBy(b):this.models.sort(b);a.silent||this.trigger("reset",this,a);return this},pluck:function(a){return f.map(this.models,function(b){return b.get(a)})},reset:function(a,b){a||(a=[]);b||(b={});for(var c=0,d=this.models.length;c<d;c++)this._removeReference(this.models[c]);this._reset();this.add(a,f.extend({silent:!0},b));b.silent||this.trigger("reset",this,b);return this},fetch:function(a){a=a?f.clone(a):{};void 0===a.parse&&(a.parse=!0);var b=this,c=a.success;a.success=function(d,
e,f){b[a.add?"add":"reset"](b.parse(d,f),a);c&&c(b,d)};a.error=g.wrapError(a.error,b,a);return(this.sync||g.sync).call(this,"read",this,a)},create:function(a,b){var c=this,b=b?f.clone(b):{},a=this._prepareModel(a,b);if(!a)return!1;b.wait||c.add(a,b);var d=b.success;b.success=function(e,f){b.wait&&c.add(e,b);d?d(e,f):e.trigger("sync",a,f,b)};a.save(null,b);return a},parse:function(a){return a},chain:function(){return f(this.models).chain()},_reset:function(){this.length=0;this.models=[];this._byId=
{};this._byCid={}},_prepareModel:function(a,b){b||(b={});a instanceof o?a.collection||(a.collection=this):(b.collection=this,a=new this.model(a,b),a._validate(a.attributes,b)||(a=!1));return a},_removeReference:function(a){this==a.collection&&delete a.collection;a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){("add"==a||"remove"==a)&&c!=this||("destroy"==a&&this.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],this._byId[b.id]=b),this.trigger.apply(this,
arguments))}});f.each("forEach,each,map,reduce,reduceRight,find,detect,filter,select,reject,every,all,some,any,include,contains,invoke,max,min,sortBy,sortedIndex,toArray,size,first,initial,rest,last,without,indexOf,shuffle,lastIndexOf,isEmpty,groupBy".split(","),function(a){r.prototype[a]=function(){return f[a].apply(f,[this.models].concat(f.toArray(arguments)))}});var u=g.Router=function(a){a||(a={});a.routes&&(this.routes=a.routes);this._bindRoutes();this.initialize.apply(this,arguments)},B=/:\w+/g,
C=/\*\w+/g,D=/[-[\]{}()+?.,\\^$|#\s]/g;f.extend(u.prototype,k,{initialize:function(){},route:function(a,b,c){g.history||(g.history=new m);f.isRegExp(a)||(a=this._routeToRegExp(a));c||(c=this[b]);g.history.route(a,f.bind(function(d){d=this._extractParameters(a,d);c&&c.apply(this,d);this.trigger.apply(this,["route:"+b].concat(d));g.history.trigger("route",this,b,d)},this));return this},navigate:function(a,b){g.history.navigate(a,b)},_bindRoutes:function(){if(this.routes){var a=[],b;for(b in this.routes)a.unshift([b,
this.routes[b]]);b=0;for(var c=a.length;b<c;b++)this.route(a[b][0],a[b][1],this[a[b][1]])}},_routeToRegExp:function(a){a=a.replace(D,"\\$&").replace(B,"([^/]+)").replace(C,"(.*?)");return RegExp("^"+a+"$")},_extractParameters:function(a,b){return a.exec(b).slice(1)}});var m=g.History=function(){this.handlers=[];f.bindAll(this,"checkUrl")},s=/^[#\/]/,E=/msie [\w.]+/;m.started=!1;f.extend(m.prototype,k,{interval:50,getHash:function(a){return(a=(a?a.location:window.location).href.match(/#(.*)$/))?a[1]:
""},getFragment:function(a,b){if(null==a)if(this._hasPushState||b){var a=window.location.pathname,c=window.location.search;c&&(a+=c)}else a=this.getHash();a.indexOf(this.options.root)||(a=a.substr(this.options.root.length));return a.replace(s,"")},start:function(a){if(m.started)throw Error("Backbone.history has already been started");m.started=!0;this.options=f.extend({},{root:"/"},this.options,a);this._wantsHashChange=!1!==this.options.hashChange;this._wantsPushState=!!this.options.pushState;this._hasPushState=
!(!this.options.pushState||!window.history||!window.history.pushState);var a=this.getFragment(),b=document.documentMode;if(b=E.exec(navigator.userAgent.toLowerCase())&&(!b||7>=b))this.iframe=i('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(a);this._hasPushState?i(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!b?i(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,
this.interval));this.fragment=a;a=window.location;b=a.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!b)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&b&&a.hash&&(this.fragment=this.getHash().replace(s,""),window.history.replaceState({},document.title,a.protocol+"//"+a.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},
stop:function(){i(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);m.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(){var a=this.getFragment();a==this.fragment&&this.iframe&&(a=this.getFragment(this.getHash(this.iframe)));if(a==this.fragment)return!1;this.iframe&&this.navigate(a);this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(a){var b=this.fragment=this.getFragment(a);return f.any(this.handlers,
function(a){if(a.route.test(b))return a.callback(b),!0})},navigate:function(a,b){if(!m.started)return!1;if(!b||!0===b)b={trigger:b};var c=(a||"").replace(s,"");this.fragment!=c&&(this._hasPushState?(0!=c.indexOf(this.options.root)&&(c=this.options.root+c),this.fragment=c,window.history[b.replace?"replaceState":"pushState"]({},document.title,c)):this._wantsHashChange?(this.fragment=c,this._updateHash(window.location,c,b.replace),this.iframe&&c!=this.getFragment(this.getHash(this.iframe))&&(b.replace||
this.iframe.document.open().close(),this._updateHash(this.iframe.location,c,b.replace))):window.location.assign(this.options.root+a),b.trigger&&this.loadUrl(a))},_updateHash:function(a,b,c){c?a.replace(a.toString().replace(/(javascript:|#).*$/,"")+"#"+b):a.hash=b}});var v=g.View=function(a){this.cid=f.uniqueId("view");this._configure(a||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()},F=/^(\S+)\s*(.*)$/,w="model,collection,el,id,attributes,className,tagName".split(",");
f.extend(v.prototype,k,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();return this},make:function(a,b,c){a=document.createElement(a);b&&i(a).attr(b);c&&i(a).html(c);return a},setElement:function(a,b){this.$el&&this.undelegateEvents();this.$el=a instanceof i?a:i(a);this.el=this.$el[0];!1!==b&&this.delegateEvents();return this},delegateEvents:function(a){if(a||(a=n(this,"events"))){this.undelegateEvents();
for(var b in a){var c=a[b];f.isFunction(c)||(c=this[a[b]]);if(!c)throw Error('Method "'+a[b]+'" does not exist');var d=b.match(F),e=d[1],d=d[2],c=f.bind(c,this),e=e+(".delegateEvents"+this.cid);""===d?this.$el.bind(e,c):this.$el.delegate(d,e,c)}}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(a){this.options&&(a=f.extend({},this.options,a));for(var b=0,c=w.length;b<c;b++){var d=w[b];a[d]&&(this[d]=a[d])}this.options=a},_ensureElement:function(){if(this.el)this.setElement(this.el,
!1);else{var a=n(this,"attributes")||{};this.id&&(a.id=this.id);this.className&&(a["class"]=this.className);this.setElement(this.make(this.tagName,a),!1)}}});o.extend=r.extend=u.extend=v.extend=function(a,b){var c=G(this,a,b);c.extend=this.extend;return c};var H={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};g.sync=function(a,b,c){var d=H[a];c||(c={});var e={type:d,dataType:"json"};c.url||(e.url=n(b,"url")||t());if(!c.data&&b&&("create"==a||"update"==a))e.contentType="application/json",
e.data=JSON.stringify(b.toJSON());g.emulateJSON&&(e.contentType="application/x-www-form-urlencoded",e.data=e.data?{model:e.data}:{});if(g.emulateHTTP&&("PUT"===d||"DELETE"===d))g.emulateJSON&&(e.data._method=d),e.type="POST",e.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",d)};"GET"!==e.type&&!g.emulateJSON&&(e.processData=!1);return i.ajax(f.extend(e,c))};g.wrapError=function(a,b,c){return function(d,e){e=d===b?e:d;a?a(b,e,c):b.trigger("error",b,e,c)}};var x=function(){},G=function(a,
b,c){var d;d=b&&b.hasOwnProperty("constructor")?b.constructor:function(){a.apply(this,arguments)};f.extend(d,a);x.prototype=a.prototype;d.prototype=new x;b&&f.extend(d.prototype,b);c&&f.extend(d,c);d.prototype.constructor=d;d.__super__=a.prototype;return d},n=function(a,b){return!a||!a[b]?null:f.isFunction(a[b])?a[b]():a[b]},t=function(){throw Error('A "url" property or function must be specified');}}).call(this);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/lib/jquery.effects.core.js' */
/*!
 * jQuery UI Effects @VERSION
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/
 */
jQuery.effects||function(e,t){function n(t){var n;return t&&t.constructor==Array&&3==t.length?t:(n=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(t))?[parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10)]:(n=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(t))?[2.55*parseFloat(n[1]),2.55*parseFloat(n[2]),2.55*parseFloat(n[3])]:(n=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(t))?[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)]:(n=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(t))?[parseInt(n[1]+n[1],16),parseInt(n[2]+n[2],16),parseInt(n[3]+n[3],16)]:(n=/rgba\(0, 0, 0, 0\)/.exec(t))?a.transparent:a[e.trim(t).toLowerCase()]}e.effects={},e.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","borderColor","color","outlineColor"],(function(t,a){e.fx.step[a]=function(t){t.colorInit||(t.start=function(t,a){var r;do{if(""!=(r=e.curCSS(t,a))&&"transparent"!=r||e.nodeName(t,"body"))break;a="backgroundColor"}while(t=t.parentNode);return n(r)}(t.elem,a),t.end=n(t.end),t.colorInit=!0),t.elem.style[a]="rgb("+Math.max(Math.min(parseInt(t.pos*(t.end[0]-t.start[0])+t.start[0],10),255),0)+","+Math.max(Math.min(parseInt(t.pos*(t.end[1]-t.start[1])+t.start[1],10),255),0)+","+Math.max(Math.min(parseInt(t.pos*(t.end[2]-t.start[2])+t.start[2],10),255),0)+")"}}));var a={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]},r=["add","remove","toggle"],s={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};function i(){var e,t=document.defaultView?document.defaultView.getComputedStyle(this,null):this.currentStyle,n={};if(t&&t.length&&t[0]&&t[t[0]])for(var a=t.length;a--;)"string"==typeof t[e=t[a]]&&(n[e.replace(/\-(\w)/g,(function(e,t){return t.toUpperCase()}))]=t[e]);else for(e in t)"string"==typeof t[e]&&(n[e]=t[e]);return n}function o(t){var n,a;for(n in t)(null==(a=t[n])||e.isFunction(a)||n in s||/scrollbar/.test(n)||!/color/i.test(n)&&isNaN(parseFloat(a)))&&delete t[n];return t}function u(t,n,a,r){return"object"==typeof t&&(r=n,a=null,t=(n=t).effect),e.isFunction(n)&&(r=n,a=null,n={}),("number"==typeof n||e.fx.speeds[n])&&(r=a,a=n,n={}),e.isFunction(a)&&(r=a,a=null),n=n||{},a=a||n.duration,[t,n,a=e.fx.off?0:"number"==typeof a?a:a in e.fx.speeds?e.fx.speeds[a]:e.fx.speeds._default,r=r||n.complete]}function c(t){return!(t&&"number"!=typeof t&&!e.fx.speeds[t])||"string"==typeof t&&!e.effects[t]}e.effects.animateClass=function(t,n,a,s){return e.isFunction(a)&&(s=a,a=null),this.queue((function(){var u,c=e(this),f=c.attr("style")||" ",l=o(i.call(this)),h=c.attr("class");e.each(r,(function(e,n){t[n]&&c[n+"Class"](t[n])})),u=o(i.call(this)),c.attr("class",h),c.animate(function(e,t){var n,a={_:0};for(n in t)e[n]!=t[n]&&(a[n]=t[n]);return a}(l,u),{queue:!1,duration:n,easing:a,complete:function(){e.each(r,(function(e,n){t[n]&&c[n+"Class"](t[n])})),"object"==typeof c.attr("style")?(c.attr("style").cssText="",c.attr("style").cssText=f):c.attr("style",f),s&&s.apply(this,arguments),e.dequeue(this)}})}))},e.fn.extend({_addClass:e.fn.addClass,addClass:function(t,n,a,r){return n?e.effects.animateClass.apply(this,[{add:t},n,a,r]):this._addClass(t)},_removeClass:e.fn.removeClass,removeClass:function(t,n,a,r){return n?e.effects.animateClass.apply(this,[{remove:t},n,a,r]):this._removeClass(t)},_toggleClass:e.fn.toggleClass,toggleClass:function(n,a,r,s,i){return"boolean"==typeof a||a===t?r?e.effects.animateClass.apply(this,[a?{add:n}:{remove:n},r,s,i]):this._toggleClass(n,a):e.effects.animateClass.apply(this,[{toggle:n},a,r,s])},switchClass:function(t,n,a,r,s){return e.effects.animateClass.apply(this,[{add:n,remove:t},a,r,s])}}),e.extend(e.effects,{version:"@VERSION",save:function(e,t){for(var n=0;n<t.length;n++)null!==t[n]&&e.data("ec.storage."+t[n],e[0].style[t[n]])},restore:function(e,t){for(var n=0;n<t.length;n++)null!==t[n]&&e.css(t[n],e.data("ec.storage."+t[n]))},setMode:function(e,t){return"toggle"==t&&(t=e.is(":hidden")?"show":"hide"),t},getBaseline:function(e,t){var n,a;switch(e[0]){case"top":n=0;break;case"middle":n=.5;break;case"bottom":n=1;break;default:n=e[0]/t.height}switch(e[1]){case"left":a=0;break;case"center":a=.5;break;case"right":a=1;break;default:a=e[1]/t.width}return{x:a,y:n}},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var n={width:t.outerWidth(!0),height:t.outerHeight(!0),float:t.css("float")},a=e("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),r=document.activeElement;return t.wrap(a),(t[0]===r||e.contains(t[0],r))&&e(r).focus(),a=t.parent(),"static"==t.css("position")?(a.css({position:"relative"}),t.css({position:"relative"})):(e.extend(n,{position:t.css("position"),zIndex:t.css("z-index")}),e.each(["top","left","bottom","right"],(function(e,a){n[a]=t.css(a),isNaN(parseInt(n[a],10))&&(n[a]="auto")})),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),a.css(n).show()},removeWrapper:function(t){var n,a=document.activeElement;return t.parent().is(".ui-effects-wrapper")?(n=t.parent().replaceWith(t),(t[0]===a||e.contains(t[0],a))&&e(a).focus(),n):t},setTransition:function(t,n,a,r){return r=r||{},e.each(n,(function(e,n){unit=t.cssUnit(n),unit[0]>0&&(r[n]=unit[0]*a+unit[1])})),r}}),e.fn.extend({effect:function(t,n,a,r){var s=u.apply(this,arguments),i={options:s[1],duration:s[2],callback:s[3]},o=i.options.mode,c=e.effects[t];return e.fx.off||!c?o?this[o](i.duration,i.callback):this.each((function(){i.callback&&i.callback.call(this)})):c.call(this,i)},_show:e.fn.show,show:function(e){if(c(e))return this._show.apply(this,arguments);var t=u.apply(this,arguments);return t[1].mode="show",this.effect.apply(this,t)},_hide:e.fn.hide,hide:function(e){if(c(e))return this._hide.apply(this,arguments);var t=u.apply(this,arguments);return t[1].mode="hide",this.effect.apply(this,t)},__toggle:e.fn.toggle,toggle:function(t){if(c(t)||"boolean"==typeof t||e.isFunction(t))return this.__toggle.apply(this,arguments);var n=u.apply(this,arguments);return n[1].mode="toggle",this.effect.apply(this,n)},cssUnit:function(t){var n=this.css(t),a=[];return e.each(["em","px","%","pt"],(function(e,t){n.indexOf(t)>0&&(a=[parseFloat(n),t])})),a}}),e.easing.jswing=e.easing.swing,e.extend(e.easing,{def:"easeOutQuad",swing:function(t,n,a,r,s){return e.easing[e.easing.def](t,n,a,r,s)},easeInQuad:function(e,t,n,a,r){return a*(t/=r)*t+n},easeOutQuad:function(e,t,n,a,r){return-a*(t/=r)*(t-2)+n},easeInOutQuad:function(e,t,n,a,r){return(t/=r/2)<1?a/2*t*t+n:-a/2*(--t*(t-2)-1)+n},easeInCubic:function(e,t,n,a,r){return a*(t/=r)*t*t+n},easeOutCubic:function(e,t,n,a,r){return a*((t=t/r-1)*t*t+1)+n},easeInOutCubic:function(e,t,n,a,r){return(t/=r/2)<1?a/2*t*t*t+n:a/2*((t-=2)*t*t+2)+n},easeInQuart:function(e,t,n,a,r){return a*(t/=r)*t*t*t+n},easeOutQuart:function(e,t,n,a,r){return-a*((t=t/r-1)*t*t*t-1)+n},easeInOutQuart:function(e,t,n,a,r){return(t/=r/2)<1?a/2*t*t*t*t+n:-a/2*((t-=2)*t*t*t-2)+n},easeInQuint:function(e,t,n,a,r){return a*(t/=r)*t*t*t*t+n},easeOutQuint:function(e,t,n,a,r){return a*((t=t/r-1)*t*t*t*t+1)+n},easeInOutQuint:function(e,t,n,a,r){return(t/=r/2)<1?a/2*t*t*t*t*t+n:a/2*((t-=2)*t*t*t*t+2)+n},easeInSine:function(e,t,n,a,r){return-a*Math.cos(t/r*(Math.PI/2))+a+n},easeOutSine:function(e,t,n,a,r){return a*Math.sin(t/r*(Math.PI/2))+n},easeInOutSine:function(e,t,n,a,r){return-a/2*(Math.cos(Math.PI*t/r)-1)+n},easeInExpo:function(e,t,n,a,r){return 0==t?n:a*Math.pow(2,10*(t/r-1))+n},easeOutExpo:function(e,t,n,a,r){return t==r?n+a:a*(1-Math.pow(2,-10*t/r))+n},easeInOutExpo:function(e,t,n,a,r){return 0==t?n:t==r?n+a:(t/=r/2)<1?a/2*Math.pow(2,10*(t-1))+n:a/2*(2-Math.pow(2,-10*--t))+n},easeInCirc:function(e,t,n,a,r){return-a*(Math.sqrt(1-(t/=r)*t)-1)+n},easeOutCirc:function(e,t,n,a,r){return a*Math.sqrt(1-(t=t/r-1)*t)+n},easeInOutCirc:function(e,t,n,a,r){return(t/=r/2)<1?-a/2*(Math.sqrt(1-t*t)-1)+n:a/2*(Math.sqrt(1-(t-=2)*t)+1)+n},easeInElastic:function(e,t,n,a,r){var s=1.70158,i=0,o=a;if(0==t)return n;if(1==(t/=r))return n+a;if(i||(i=.3*r),o<Math.abs(a)){o=a;s=i/4}else s=i/(2*Math.PI)*Math.asin(a/o);return-o*Math.pow(2,10*(t-=1))*Math.sin((t*r-s)*(2*Math.PI)/i)+n},easeOutElastic:function(e,t,n,a,r){var s=1.70158,i=0,o=a;if(0==t)return n;if(1==(t/=r))return n+a;if(i||(i=.3*r),o<Math.abs(a)){o=a;s=i/4}else s=i/(2*Math.PI)*Math.asin(a/o);return o*Math.pow(2,-10*t)*Math.sin((t*r-s)*(2*Math.PI)/i)+a+n},easeInOutElastic:function(e,t,n,a,r){var s=1.70158,i=0,o=a;if(0==t)return n;if(2==(t/=r/2))return n+a;if(i||(i=r*(.3*1.5)),o<Math.abs(a)){o=a;s=i/4}else s=i/(2*Math.PI)*Math.asin(a/o);return t<1?o*Math.pow(2,10*(t-=1))*Math.sin((t*r-s)*(2*Math.PI)/i)*-.5+n:o*Math.pow(2,-10*(t-=1))*Math.sin((t*r-s)*(2*Math.PI)/i)*.5+a+n},easeInBack:function(e,n,a,r,s,i){return i==t&&(i=1.70158),r*(n/=s)*n*((i+1)*n-i)+a},easeOutBack:function(e,n,a,r,s,i){return i==t&&(i=1.70158),r*((n=n/s-1)*n*((i+1)*n+i)+1)+a},easeInOutBack:function(e,n,a,r,s,i){return i==t&&(i=1.70158),(n/=s/2)<1?r/2*(n*n*((1+(i*=1.525))*n-i))+a:r/2*((n-=2)*n*((1+(i*=1.525))*n+i)+2)+a},easeInBounce:function(t,n,a,r,s){return r-e.easing.easeOutBounce(t,s-n,0,r,s)+a},easeOutBounce:function(e,t,n,a,r){return(t/=r)<1/2.75?a*(7.5625*t*t)+n:t<2/2.75?a*(7.5625*(t-=1.5/2.75)*t+.75)+n:t<2.5/2.75?a*(7.5625*(t-=2.25/2.75)*t+.9375)+n:a*(7.5625*(t-=2.625/2.75)*t+.984375)+n},easeInOutBounce:function(t,n,a,r,s){return n<s/2?.5*e.easing.easeInBounce(t,2*n,0,r,s)+a:.5*e.easing.easeOutBounce(t,2*n-s,0,r,s)+.5*r+a}})}(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'templates/mywork.soy' */
// This file was automatically generated from mywork.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace MyWork.Templates.
 */

if (typeof MyWork == 'undefined') { var MyWork = {}; }
if (typeof MyWork.Templates == 'undefined') { MyWork.Templates = {}; }


MyWork.Templates.mainNotification = function(opt_data, opt_ignored) {
  return MyWork.Templates.mainNotificationHeader(null) + '<ol class=\'mw-notifications-list\' role="listbox">' + MyWork.Templates.loading(null) + '</ol>' + MyWork.Templates.footer(null);
};
if (goog.DEBUG) {
  MyWork.Templates.mainNotification.soyTemplateName = 'MyWork.Templates.mainNotification';
}


MyWork.Templates.mainNotificationHeader = function(opt_data, opt_ignored) {
  return '<div id="mw-header" class="mw-header aui-toolbar" data-role="header"><h2>' + soy.$$escapeHtml('Notifications') + '</h2>' + MyWork.Templates.toggleButtons(null) + '</div>';
};
if (goog.DEBUG) {
  MyWork.Templates.mainNotificationHeader.soyTemplateName = 'MyWork.Templates.mainNotificationHeader';
}


MyWork.Templates.loading = function(opt_data, opt_ignored) {
  return '<div class=\'mw-loading\'>' + soy.$$escapeHtml('Loading...') + '</div>';
};
if (goog.DEBUG) {
  MyWork.Templates.loading.soyTemplateName = 'MyWork.Templates.loading';
}


MyWork.Templates.footer = function(opt_data, opt_ignored) {
  return '<div class="mw-footer" data-role="footer"></div>';
};
if (goog.DEBUG) {
  MyWork.Templates.footer.soyTemplateName = 'MyWork.Templates.footer';
}


MyWork.Templates.toggleButtons = function(opt_data, opt_ignored) {
  return '<ul class="mw-toggles toolbar-group"><li class="toolbar-item"><a class="mw-button-notifications toolbar-trigger" title="' + soy.$$escapeHtml('Notifications') + '"><span class="icon icon-notification"></span></a></li><li class="toolbar-item"><a class="toolbar-trigger mw-button-tasks" title="' + soy.$$escapeHtml('Personal Tasks') + '"><span class="icon icon-task"></span></a></li></ul>';
};
if (goog.DEBUG) {
  MyWork.Templates.toggleButtons.soyTemplateName = 'MyWork.Templates.toggleButtons';
}


MyWork.Templates.notificationDrilldown = function(opt_data, opt_ignored) {
  return '<div class="mw-drilldown-top" title="' + soy.$$escapeHtml('Back to notifications (type \x27u\x27)') + '"><button id="mw-drilldown-back" class="mw-drilldown-back"><span class="back-arrow"></span> ' + soy.$$escapeHtml('Back to notifications') + '</button></div><div class="mw-drilldown-container"><div class="mw-drilldown-header"></div><div class="mw-drilldown-body"></div></div>';
};
if (goog.DEBUG) {
  MyWork.Templates.notificationDrilldown.soyTemplateName = 'MyWork.Templates.notificationDrilldown';
}


MyWork.Templates.drilldownEntry = function(opt_data, opt_ignored) {
  return '<div class="mw-drilldown-icon">' + ((opt_data.notification.iconUrl) ? '<img src="' + soy.$$escapeHtml(opt_data.notification.iconUrl) + '" alt="" class="mw-drilldown-avatar avatar">' : '') + '</div><div class="mw-drilldown-item"><div class="mw-drilldown-title">' + soy.$$filterNoAutoescape(opt_data.htmlTitle) + '</div>' + ((opt_data.notification.description) ? '<div class="mw-drilldown-excerpt">' + ((opt_data.notification.highlightTextHtml) ? '<blockquote><p>' + soy.$$escapeHtml(opt_data.notification.highlightTextHtml) + '</p></blockquote>' : '') + soy.$$filterNoAutoescape(opt_data.notification.descriptionHtml) + '</div>' : '') + '<div class="mw-drilldown-actions"><ul></ul><div class="message"></div><div class="action-form"></div></div></div>';
};
if (goog.DEBUG) {
  MyWork.Templates.drilldownEntry.soyTemplateName = 'MyWork.Templates.drilldownEntry';
}


MyWork.Templates.drilldownHeader = function(opt_data, opt_ignored) {
  return '<div class="drilldown-header-title"><div class="drilldown-title">' + ((opt_data.url) ? '<a href=' + soy.$$escapeHtml(opt_data.url) + ' target="_blank">' + soy.$$filterNoAutoescape(opt_data.title) + '</a>' : soy.$$escapeHtml(opt_data.title)) + '</div><div class="drilldown-new-actions">' + ((opt_data.displayIconClass) ? '<div class="drilldown-icon ' + soy.$$escapeHtml(opt_data.displayIconClass) + '"></div>' : (opt_data.displayIconUrl) ? '<img class="drilldown-icon" src="' + soy.$$escapeHtml(opt_data.displayIconUrl) + '">' : '') + '<span class="drilldown-action-text">' + soy.$$escapeHtml(opt_data.newActionsText) + '</span></div><div class="mw-drilldown-actions"><ul></ul><div class="message"></div></div><div class="action-form"></div></div>';
};
if (goog.DEBUG) {
  MyWork.Templates.drilldownHeader.soyTemplateName = 'MyWork.Templates.drilldownHeader';
}


MyWork.Templates.notificationView = function(opt_data, opt_ignored) {
  return '<div class="mw-notification-verb-icon">' + ((opt_data.notification.displayIconClass) ? '<div class="' + soy.$$escapeHtml(opt_data.notification.displayIconClass) + '"></div>' : (opt_data.notification.displayIconUrl) ? '<div style="background:url(' + soy.$$escapeHtml(opt_data.notification.displayIconUrl) + ') no-repeat 0 0; width:16px; height:16px"></div>' : '') + '</div><h3 class="mw-notification-text"></h3><div class="mw-notification-time" title="' + soy.$$escapeHtml(opt_data.prettyTime) + '">' + soy.$$escapeHtml(opt_data.prettyTime) + '</div><div class="mw-drilldown-arrow"></div>';
};
if (goog.DEBUG) {
  MyWork.Templates.notificationView.soyTemplateName = 'MyWork.Templates.notificationView';
}


MyWork.Templates.mainTasks = function(opt_data, opt_ignored) {
  return MyWork.Templates.taskHeader(opt_data) + '<ul class="mw-tasks-list">' + MyWork.Templates.loading(null) + '</ul><div class="mw-footer" data-role="footer"><a class="view-completed">' + soy.$$escapeHtml('View completed') + '</a></div>';
};
if (goog.DEBUG) {
  MyWork.Templates.mainTasks.soyTemplateName = 'MyWork.Templates.mainTasks';
}


MyWork.Templates.deprecatedTasks = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return MyWork.Templates.deprecatedTaskHeader(opt_data) + '<div class="mw-deprecated-tasks"><div class="mw-deprecated-task-content"><div class="mw-deprecated-task-banner"><div class="mw-deprecated-task-sign"><div class="mw-deprecated-task-sign-holder"></div><div class="mw-deprecated-task-sign-box">' + soy.$$escapeHtml('We\x27ve Moved') + '</div></div></div><div class="subheading"><h3>' + soy.$$escapeHtml('Tasks have a new home') + '</h3></div><p>' + soy.$$escapeHtml('We\x27ve created a new place where you can see all tasks assigned to or created by you.') + '</p>' + ((opt_data.userMustMigrate) ? '<p>' + soy.$$escapeHtml('To help you transition to the new tasks we\x27ve just sent your existing personal tasks to your email address.') + '</p>' : '') + '</div><ul class="mw-deprecated-task-controls"><li><button id="mw-deprecated-task-show-me" class="aui-button-primary aui-button aui-style">' + soy.$$escapeHtml('Show me') + '</button></li><li><a id="mw-deprecated-task-dissmiss" href="#">' + soy.$$escapeHtml('Ok, got it!') + '</a></li></ul></div><div class="mw-footer" data-role="footer"></div>';
};
if (goog.DEBUG) {
  MyWork.Templates.deprecatedTasks.soyTemplateName = 'MyWork.Templates.deprecatedTasks';
}


MyWork.Templates.taskHeader = function(opt_data, opt_ignored) {
  return '<div class="mw-header aui-toolbar" data-role="header"><h2>' + soy.$$escapeHtml('Personal tasks') + '</h2>' + MyWork.Templates.toggleButtons(null) + '<div class="add-task-row"><button class="add-task aui-button aui-style">' + soy.$$escapeHtml(opt_data.addTaskButtonText) + '</button><div><input id="new-personal-task" type="text" placeholder="' + soy.$$escapeHtml(opt_data.addTaskPlaceholder) + '"/></div></div></div>';
};
if (goog.DEBUG) {
  MyWork.Templates.taskHeader.soyTemplateName = 'MyWork.Templates.taskHeader';
}


MyWork.Templates.deprecatedTaskHeader = function(opt_data, opt_ignored) {
  return '<div class="mw-header aui-toolbar" data-role="header"><h2>' + soy.$$escapeHtml('Personal tasks') + '</h2>' + MyWork.Templates.toggleButtons(null) + '</div>';
};
if (goog.DEBUG) {
  MyWork.Templates.deprecatedTaskHeader.soyTemplateName = 'MyWork.Templates.deprecatedTaskHeader';
}


MyWork.Templates.personalTask = function(opt_data, opt_ignored) {
  return '<div class="entire-task notes"><div class="handle"></div><div class="spacer"></div><div class="mw-task-checkbox-w"><div class="mw-task-checkbox"></div></div><div class="spacer"></div><div class="item-content notes">' + soy.$$escapeHtml(opt_data.text) + '</div>' + ((opt_data.task.item.url) ? (opt_data.task.item.displayIconClass) ? '<a href="' + soy.$$escapeHtml(opt_data.task.item.url) + '" title="' + soy.$$escapeHtml(opt_data.task.item.title) + '" class="' + soy.$$escapeHtml(opt_data.task.item.displayIconClass) + ' mw-task-link" target="_blank"></a>' : '<a href="' + soy.$$escapeHtml(opt_data.task.item.url) + '" title="' + soy.$$escapeHtml(opt_data.task.item.title) + '" class="mw-task-link" target="_blank" style="background-image:url(' + soy.$$escapeHtml(opt_data.task.item.displayIconUrl) + ')"></a>' : '') + '<div class="mw-drilldown-arrow"></div></div>';
};
if (goog.DEBUG) {
  MyWork.Templates.personalTask.soyTemplateName = 'MyWork.Templates.personalTask';
}


MyWork.Templates.personalTaskDetail = function(opt_data, opt_ignored) {
  return '<div class="mw-drilldown-top" title="' + soy.$$escapeHtml(opt_data.backToTasksText) + '"><a class="mw-taskdetail-back"><span class="back-arrow"></span> ' + soy.$$escapeHtml(opt_data.backToTasksText) + '</a></div><div class="mw-taskdetail-outer-container"><div class="mw-taskdetail-header"><span class="mw-task-checkbox-w"><a class="mw-task-checkbox" tabindex="1"></a></span>' + ((opt_data.task.readonlyTitle) ? '<a class="mw-taskdetail-title" href="' + soy.$$escapeHtml(opt_data.task.item.url) + '" target="_blank" tabindex="2">' + soy.$$escapeHtml(opt_data.task.title) + '</a>' : '<input type="text" class="mw-taskdetail-title" value="' + soy.$$escapeHtml(opt_data.task.title) + '" tabindex="2"/>') + '</div><div class="mw-taskdetail-container">' + MyWork.Templates.taskDetailBody(opt_data) + MyWork.Templates.taskDetailDelete(null) + '</div></div>';
};
if (goog.DEBUG) {
  MyWork.Templates.personalTaskDetail.soyTemplateName = 'MyWork.Templates.personalTaskDetail';
}


MyWork.Templates.taskDetailBody = function(opt_data, opt_ignored) {
  return '<div tabindex="3" class="mw-taskdetail-notes ' + ((opt_data.task.item.url) ? 'short' : '') + '" ></div><textarea tabindex="3" class="mw-taskdetail-notes-textarea ' + ((opt_data.task.item.url) ? 'short' : '') + '"></textarea>' + ((opt_data.task.item.url) ? '<div class="mw-related-content">' + ((opt_data.task.item.displayIconClass) ? '<div type="text" class="' + soy.$$escapeHtml(opt_data.task.item.displayIconClass) + ' mw-related-title">' : '<div type="text" class="mw-related-title" style="background:url(' + soy.$$escapeHtml(opt_data.task.item.displayIconUrl) + ') no-repeat 0 0;">') + '<a href="' + soy.$$escapeHtml(opt_data.task.item.url) + '" target="_blank">' + soy.$$escapeHtml(opt_data.task.item.title) + '</a></div></div>' : '');
};
if (goog.DEBUG) {
  MyWork.Templates.taskDetailBody.soyTemplateName = 'MyWork.Templates.taskDetailBody';
}


MyWork.Templates.taskDetailTags = function(opt_data, opt_ignored) {
  return '<div class="mw-taskdetail-tags"><h1 id="mw-taskdetail-header">' + soy.$$escapeHtml('Tags') + '</h1><div class="mw-taskdetail-taglist"></div></div>';
};
if (goog.DEBUG) {
  MyWork.Templates.taskDetailTags.soyTemplateName = 'MyWork.Templates.taskDetailTags';
}


MyWork.Templates.taskDetailDelete = function(opt_data, opt_ignored) {
  return '<div class="mw-taskdetail-action-buttons"><button tabindex="4" class="mw-taskdetail-save aui-button aui-button-primary">' + soy.$$escapeHtml('Save') + '</button><button tabindex="5" class="mw-taskdetail-delete aui-button">' + soy.$$escapeHtml('Delete') + '</button></div>';
};
if (goog.DEBUG) {
  MyWork.Templates.taskDetailDelete.soyTemplateName = 'MyWork.Templates.taskDetailDelete';
}


MyWork.Templates.noNotifications = function(opt_data, opt_ignored) {
  return '<li class="mw-no-notifications"><h1>' + soy.$$escapeHtml(opt_data.heading) + '</h1><div class="subheading"><p>' + soy.$$escapeHtml(opt_data.subheading) + '</p></div>' + soy.$$escapeHtml(opt_data.body) + '</li>';
};
if (goog.DEBUG) {
  MyWork.Templates.noNotifications.soyTemplateName = 'MyWork.Templates.noNotifications';
}


MyWork.Templates.noTasks = function(opt_data, opt_ignored) {
  return '<div class="mw-no-tasks"><div class="taskarrow-callout"></div><li class="empty-task"><div class="entire-task empty"><p>' + soy.$$escapeHtml(opt_data.noTaskItem) + '</p></div></li><p>' + soy.$$escapeHtml(opt_data.noTaskDescription) + '</p><div class="list-container"><div><ul><li>' + soy.$$escapeHtml(opt_data.noTask1) + '</li><li>' + soy.$$escapeHtml(opt_data.noTask2) + '</li></ul></div><div class="addtask-callout-container"><div class="addtask-callout"></div></div></div><div class="list-container"><div class="task-callout-list"><ul><li>' + soy.$$escapeHtml(opt_data.noTask3) + '</li></ul></div><div class="task-callout-container"><div class="task-callout"></div></div></div>';
};
if (goog.DEBUG) {
  MyWork.Templates.noTasks.soyTemplateName = 'MyWork.Templates.noTasks';
}


MyWork.Templates.showMore = function(opt_data, opt_ignored) {
  return '<li class="mw-mobile-entry-item more-trigger"><a href="#" class="mw-show-more button gradient-background">' + soy.$$escapeHtml('More') + '</a></li>';
};
if (goog.DEBUG) {
  MyWork.Templates.showMore.soyTemplateName = 'MyWork.Templates.showMore';
}


MyWork.Templates.completedCategory = function(opt_data, opt_ignored) {
  return '<li class=\'task completed category\'>' + soy.$$escapeHtml(opt_data.category) + '</li>';
};
if (goog.DEBUG) {
  MyWork.Templates.completedCategory.soyTemplateName = 'MyWork.Templates.completedCategory';
}


MyWork.Templates.openLinkAction = function(opt_data, opt_ignored) {
  return '<a target="' + soy.$$escapeHtml(opt_data.notification.target) + '" href="' + soy.$$escapeHtml(opt_data.url) + '" data-url="' + soy.$$escapeHtml(opt_data.notification.parent.url) + '">' + soy.$$escapeHtml(opt_data.displayName) + '</a>';
};
if (goog.DEBUG) {
  MyWork.Templates.openLinkAction.soyTemplateName = 'MyWork.Templates.openLinkAction';
}


MyWork.Templates.inlineActionForm = function(opt_data, opt_ignored) {
  return '<form class="inline-action-form"></form>';
};
if (goog.DEBUG) {
  MyWork.Templates.inlineActionForm.soyTemplateName = 'MyWork.Templates.inlineActionForm';
}


MyWork.Templates.inlineActionTextarea = function(opt_data, opt_ignored) {
  return '<div class="expandingArea"><pre><span></span><br></pre><textarea class="mw-inline-textarea" name="comment" rows="3"></textarea></div>';
};
if (goog.DEBUG) {
  MyWork.Templates.inlineActionTextarea.soyTemplateName = 'MyWork.Templates.inlineActionTextarea';
}


MyWork.Templates.inlineActionSubmit = function(opt_data, opt_ignored) {
  return '<div class="inline-action-submit"><button class="aui-button aui-button-primary add-comment-button disabled">' + soy.$$escapeHtml(opt_data.submitLabel) + '</button><button class="aui-button inline-cancel">' + soy.$$escapeHtml('Cancel') + '</button></div>';
};
if (goog.DEBUG) {
  MyWork.Templates.inlineActionSubmit.soyTemplateName = 'MyWork.Templates.inlineActionSubmit';
}


MyWork.Templates.categoryLabel = function(opt_data, opt_ignored) {
  return '<span class="category-label">' + soy.$$escapeHtml(opt_data.text) + '</span>';
};
if (goog.DEBUG) {
  MyWork.Templates.categoryLabel.soyTemplateName = 'MyWork.Templates.categoryLabel';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/models/configuration-model.js' */
(function(){function g(){return Array.prototype.slice.apply(arguments).join(".")}MW.Configuration=Backbone.Model.extend({parse:function(a){a.objectActions={};a.itemActions={};a.taskActions={};var c=function(b,d,e){_(d).map(function(f){b[f]=(b[f]||[]).concat([e])})};_(a.actions).each(function(b,d){b.id=d;c(a.objectActions,b.objectActions,b);c(a.itemActions,b.actions,b);c(a.taskActions,b.taskActions,b);b.attrs=b.attrs||{};b.attrs.getAlternateAction=function(){return a.actions[b.attrs.alternateAction]}});
return a},appendUrl:function(a){return(a=this.getProperty(a))?this.getUrl()+a:a},getUrl:function(){return this.get("url")||""},getProperty:function(){var a=g.apply(this,arguments);return this.get("properties")[a]||""},getUserUrl:function(a,c){return(this.get("url")||"")+MW.formatString(this.getProperty(a+".user_url"),{username:encodeURIComponent(c)})},getObjectActions:function(a,c,b){return this.getMyActions(this.get("objectActions"),a,c,b)},getActions:function(a,c,b){return this.getMyActions(this.get("itemActions"),
a,c,b)},getTaskActions:function(a,c,b){return this.getMyActions(this.get("taskActions"),a,c,b)},getMyActions:function(a,c,b,d){a=a||{};d=d||{};a="invite"===b?[].concat(a[c+"."+b]||[]):[].concat(a[c]||[],a[c+"."+b]||[]);return _(a).filter(_.bind(function(e){return this.isMetadataMatch(d,e.attrs.condition||{})},this))},isMetadataMatch:function(a,c){return _.all(c,function(b,d){return a[d]==b})},i18n:function(a){return this.get("i18n")[a]}})})();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/models/task-model.js' */
MW.Task=Backbone.Model.extend({setState:function(a){0<this.config.getTaskActions(this.get("entity"),this.get("action")).length&&MW.$.ajax({type:"POST",url:MW.contextPath+"/rest/mywork/1/action/task",dataType:"json",contentType:"application/json",data:JSON.stringify({application:this.get("application"),qualifiedAction:this.get("category"),id:this.get("id"),status:a,metadata:this.get("metadata")})});this.save({status:a});MW.Notifications.setStatusByGlobalId(this.get("globalId"),a)},reorder:function(a){MW.$.ajax({url:MW.contextPath+
"/rest/mywork/latest/task/"+this.get("id")+"/position",type:"PUT",contentType:"application/json",data:JSON.stringify({before:a})})},initialize:function(){this.parse(this.attributes)},parse:function(a){a.item||(a.item={});var b=a.item,d=MW.Configurations.hasConfig(a),c=this.config=MW.Configurations.getFromNotification(a);a.title=a.title||b.title;a.category=a.application+"."+a.entity;d&&b&&(b.url&&0===b.url.indexOf("/")&&(b.url=c.get("url")+b.url),b.iconUrl&&0===b.iconUrl.indexOf("/")&&(b.iconUrl=c.get("url")+
b.iconUrl));b.displayIconUrl=b.iconUrl||this.config.appendUrl(a.category);this.hasDisplayIconClass(a.entity)&&(b.displayIconClass="mw-icon-"+a.entity);a.readonlyTitle="true"==this.config.getProperty(a.category,"readonlyTitle");return a},hasDisplayIconClass:function(a){return _.include(["blog","page","comment","inline-task"],a)},setTitle:function(a){this.get("title")!=a&&this.save({title:a})},setNotes:function(a){this.get("notes")!=a&&(MW.$.ajax({url:MW.contextPath+"/rest/mywork/latest/task/"+this.get("id")+
"/notes",type:"PUT",contentType:"application/json",data:JSON.stringify(a)}),this.set({notes:a}))},isCompleted:function(){return"DONE"===this.get("status")}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/models/notification-model.js' */
AJS.EventQueue=AJS.EventQueue||[];
MW.Notification=Backbone.Model.extend({getPrettyTime:function(){return MW.getPrettyTime(this.get("created"))},open:function(){this.get("parent").trigger("open",this);window.open(this.attributes.url).opener=null},toEventJSON:function(){return _.extend(MW.pick(this.attributes,"id","globalId","status"),MW.pick(this.get("parent").attributes,"application","entity","action"))},executeInlineAction:function(a){var b=this.getActionData(a.actionName,a.target);b=a.extraData?_.extend(a.extraData,b):b;MW.$.ajax({type:"POST",
url:MW.contextPath+"/rest/mywork/1/action",data:JSON.stringify(b),dataType:"json",success:a.success,error:a.error,contentType:"application/json"})},getActionData:function(a,b){return{globalId:this.get("globalId"),qualifiedAction:this.get("parent").get("category")+"."+a,application:this.get("parent").get("application"),metadata:this.get("metadata"),target:b,id:this.get("id")}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/models/notification-group-model.js' */
AJS.EventQueue=AJS.EventQueue||[];
MW.NotificationGroup=Backbone.Model.extend({initialize:function(a,b){a=this.globalEvents=b.globalEvents;this.config=b.config;var c=this;this.notifications=[];a&&(a.on("focusClickedNotification",this.focusSelected,this),a.on("removeDrilldownFocused",function(){c.get("drilldownFocused")&&c.set("drilldownFocused",!1)}),a.on("removeMainFocused",function(){c.get("mainFocused")&&c.set("mainFocused",!1)}))},setState:function(a,b){this.set("status",a);var c=this.notifications[0].get("id");MW.$.ajax({url:MW.contextPath+
"/rest/mywork/latest/notification/"+c+"/status",type:"PUT",contentType:"application/json",data:JSON.stringify(a),success:function(d){b&&b();_.isObject(d)||(d=JSON.parse(d));MW.Tasks.getByGlobalIdDeferred(d.globalId,function(e){e&&e.isCompleted()&&e.set("globalId","",{silent:!0})});MW.Tasks.add(d,{at:0})}})},hasTask:function(){return"TODO"===this.get("status")},createTask:function(a){this.setState("TODO",a);a=this.get("globalId");MW.Notifications.setStatusByGlobalId(a,"TODO");this.globalEvents.trigger("taskCreated");
AJS.EventQueue.push({name:"mywork.createTask",properties:{changeStatusTo:this.get("status")}})},appendNotifications:function(a){var b=this;a=_.map(a,function(c){c=MW.$.extend(c,{globalEvents:b.globalEvents,parent:b});return new MW.Notification(c)});this.notifications=_.sortBy(a.concat(this.notifications),function(c){return-1*c.get("created")});this.updateStatus();this.set("notifications",this.notifications);this.set("updated",_.first(this.notifications).get("created"));this.trigger("modified",this);
this.globalEvents.trigger("removeDrilldownFocused")},getPrettyTime:function(){return MW.getPrettyTime(_.first(this.notifications).get("created"))},getUnreadNotifications:function(){return _.filter(this.get("notifications"),function(a){return!a.get("read")})},getMetadata:function(){return this.notifications[0].get("metadata")},resetFocused:function(a){this.removeFocus();(a||_.first(this.notifications)).set("drilldownFocused",!0,{silent:!0})},updateStatus:function(){var a=this.notifications[0].get("globalId");
_.any(this.notifications,function(b){return b.get("globalId")!==a})?(this.unset("globalId"),this.unset("status")):(this.set("globalId",this.notifications[0].get("globalId")),this.set("status",this.notifications[0].get("status")))},setStatusByGlobalId:function(a,b){this.get("globalId")===a?(this.set("status",b),_.each(this.notifications,function(c){c.set("status",b)})):_.each(this.notifications,function(c){c.get("globalId")===a&&c.set("status",b)})},hasNewNotifications:function(){return!this.notifications[0].get("read")},
i18ns:function(a,b){return this.i18n.apply(this,[a+(1<b?"s":"")].concat(Array.prototype.slice.call(arguments,1)))},i18n:function(a){var b={};_.each(Array.prototype.slice.call(arguments,1),function(c,d){b[d]=c});return this.i18nWithMap(a,b)},i18nWithMap:function(a,b){return this.entityI18n(this.get("action")+(a?"."+a:""),b)},i18nHtml:function(a,b){a=MW.escapeHTML(this.i18nWithMap(a,MW.$.extend({user:"{user}"},b)));if(!a)return"";var c=this.getMetadata();b=this.config.getUserUrl(this.get("application"),
c.username);c=c.user||"";b=b?MW.$("\x3ca /\x3e").attr("target","_blank").attr("href",b).text(c).wrap("\x3cdiv /\x3e").parent().html():MW.escapeHTML(c);return a.replace("{user}",b)},entityI18n:function(a,b){a=this.get("category")+(a?"."+a:"");return(a=this.config.i18n(a))?MW.formatString(a,_.extend({},this.getMetadata(),b)):""},focused:function(){for(var a=0;a<this.notifications.length;a++)if(this.notifications[a].get("drilldownFocused"))return this.notifications[a]},focusOlder:function(){var a=_.indexOf(this.notifications,
this.focused());a=this.notifications[Math.min(this.notifications.length-1,a+1)];a.get("drilldownFocused")||(this.removeFocus(),a.set("drilldownFocused",!0));return a},focusNewer:function(){var a=_.indexOf(this.notifications,this.focused());0<a&&(this.removeFocus(),this.notifications[a-1].set("drilldownFocused",!0))},focusSelected:function(a){var b=this.focused();b&&b!==a&&(this.removeFocus(),a.set("drilldownFocused",!0))},focusOldest:function(){this.removeFocus();_.last(this.notifications).set("drilldownFocused",
!0)},removeFocus:function(){_.each(this.notifications,function(a){a.set("drilldownFocused",!1)})}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/collections/configuration-collection.js' */
MW.ConfigurationCollection=Backbone.Collection.extend({initialize:function(a){this.model=MW.Configuration;this.url=MW.contextPath+"/rest/mywork/latest/configuration";this.blank=new MW.Configuration({i18n:{},properties:{}})},fetchOnce:_.once(function(){var a=MW.$.Deferred();this.fetch({success:function(){a.resolve()},data:{version:MW.configurationVersion}});return a}),getFromNotificationRaw:function(a){return this.find(function(b){return(a.applicationLinkId||"")===b.get("appId")&&a.application==b.get("application")})},
getFromNotification:function(a){return this.getFromNotificationRaw(a)||this.blank},hasConfig:function(a){return"undefined"!==typeof this.getFromNotificationRaw(a)}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/collections/task-collection.js' */
MW.TaskCollection=Backbone.Collection.extend({all:function(){return this.filter(function(a){return!0})},initialize:function(){this.model=MW.Task;this.url=MW.contextPath+"/rest/mywork/latest/task";this.hasFetched=MW.Deferred()},fetchOnce:_.once(function(a){this.fetcher(a)}),fetcher:function(a){this.fetch(this.hasFetched.resolveOnSuccess(_.extend({add:!0,data:{type:"inline_task"}},a)))},reorder:function(a,b){if(b){var c=this.indexOf(b);var d=b.get("id")}else c=this.length;this.remove(a);this.add(a,
{at:c});a.reorder(d)},getByIdDeferred:function(a,b){var c=this;this.hasFetched.done(function(){b(c.get(a))})},getByGlobalIdCheckHost:function(a,b){var c=this;this.getByGlobalIdDeferred(a,function(d){d?b(d):c.fetcher({add:!1,success:function(){c.getByGlobalIdDeferred(a,b)}})})},getByGlobalIdDeferred:function(a,b){var c=this;this.hasFetched.done(function(){b(c.getByGlobalId(a))})},getByGlobalId:function(a){return this.find(function(b){return b.get("globalId")===a})},todo:function(){return this.filter(function(a){return!a.isCompleted()})},
done:function(){return this.doneBetween()},doneOlderThan:function(a){return this.doneBetween(a)},doneNewerThan:function(a){return this.doneBetween(null,a)},doneBetween:function(a,b){return this.filter(function(c){var d=new Date(c.get("updated"));if(a||b?b?a?d>=a&&d<b:d>=b:d<a:1)return c.isCompleted()})},parse:function(a){var b=this;_.each(a,function(c){c.displayName=c.item.title||""});setTimeout(function(){b.trigger("fetch")});return a}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/collections/notification-collection.js' */
MW.NotificationCollection=Backbone.Collection.extend({currentLastFetchId:0,beforeId:0,fetcher:function(a){a=a||{};if(this.firstFetch||!a.updateOnly){if(this.firstFetch)return this.fetchAfterWithLimit(a);this.firstFetch=!0;return this.fetchWithLimit(this.hasFetched.resolveOnSuccess(a))}},fetchWithLimit:function(a){a.data=a.data||{};a.data=_.extend(a.data,{limit:MW.MAX_RESULTS});return this.fetch(a)},fetchAfterWithLimit:function(a){a=_.extend(a,{add:!0});a.data=a.data||{};a.data=_.extend(a.data,{after:this.currentLastFetchId});
return this.fetchWithLimit(a)},initialize:function(a,b){this.globalEvents=b.globalEvents;this.url=MW.contextPath+"/rest/mywork/latest/notification/nested";this.model=MW.NotificationGroup;this.hasFetched=MW.Deferred();this.config=b.config},comparator:function(a,b){var d=a.attributes.pinned,e=b.attributes.pinned;if(d&&!e)return-1;if(!d&&e)return 1;a=a.attributes.updated;b=b.attributes.updated;return a<b?1:a>b?-1:0},setLastReadId:function(a){a<=this.currentLastFetchId||(this.currentLastFetchId=a,MW.$.ajax({url:MW.contextPath+
"/rest/mywork/latest/notification/lastreadid",type:"PUT",contentType:"application/json",data:JSON.stringify(this.currentLastFetchId)}))},getCategory:function(a){return a.application+"."+a.entity},geti18nKey:function(a){return this.getCategory(a)+"."+a.action},isMyWorkAuth:function(a){return"com.atlassian.mywork.host.provider"==a.application&&"authentication"==a.entity},prepareMyWorkAuth:function(a,b,d){var e=MW.createCallback(d);e&&(_.each(b,function(f){f.url+=MW.appendCallback(f.url,e);f.target=
"_top"}),a.url=b[0].url,a.target="_top")},parse:function(a){var b=this,d=[];_.each(a,function(c){c=b.initNotification(c);d=d.concat(c)});!this.currentLastFetchId&&d.length&&(d[0].mainFocused=!0);var e=0,f=[];_(d).each(function(c){_(c.notifications).each(function(h){h.id>e&&(e=h.id);b.beforeId=h.id});var g=b.getByAggregateKey(c.aggregateKey);if(g)return g.appendNotifications(c.notifications);g=new MW.NotificationGroup(c,{globalEvents:b.globalEvents,config:b.config.getFromNotification(c)});g.appendNotifications(c.notifications);
f.push(g)});this.setLastReadId(e||this.currentLastFetchId);return f},initNotification:function(a){var b=a.item;a=a.notifications;var d=this.config.hasConfig(b),e=this.config.getFromNotification(b),f=this.geti18nKey(b);this.isBasicAction(b)&&(b.displayIconClass="mw-icon-"+this.getIconClassName(b));b.category=this.getCategory(b);d?(b.objectActions=e.getObjectActions(b.entity,b.action,a[0].metadata),b.url&&0===b.url.indexOf("/")&&(b.url=e.get("url")+b.url),b.iconUrl&&0===b.iconUrl.indexOf("/")&&(b.iconUrl=
e.get("url")+b.iconUrl)):b.objectActions=b.url?[{type:"link"}]:[];b.notifications=[];this.isMyWorkAuth(b)&&this.prepareMyWorkAuth(b,a,MW.getBaseUrl());_.each(a,function(c){c.target=c.target||"_blank";c.descriptionHtml=c.description||"";c.highlightTextHtml=c.metadata&&c.metadata.highlightText;_(["br","ul","p"]).chain().map(function(g){return 0<=c.descriptionHtml.indexOf("\x3c"+g)}).any().value()||(c.descriptionHtml=c.descriptionHtml.replace(/\n/g,"\x3cbr/\x3e"));d?(c.actions=e.getActions(b.entity,
b.action,c.metadata),c.url&&0===c.url.indexOf("/")&&(c.url=e.get("url")+c.url),c.iconUrl&&0===c.iconUrl.indexOf("/")&&(c.iconUrl=e.get("url")+c.iconUrl),c.actionIconUrl&&0===c.actionIconUrl.indexOf("/")&&(c.actionIconUrl=e.get("url")+c.actionIconUrl)):c.actions=c.url?[{type:"link"}]:[];b.notifications.push(c)});b.displayIconUrl=a[0].actionIconUrl||b.iconUrl||e.appendUrl(f)||e.appendUrl(b.category);return b},isBasicAction:function(a){return"com.atlassian.mywork.providers.jira"===a.application?"comment"===
a.action:"com.atlassian.mywork.providers.confluence"===a.application?_.include("like comment task.assign mentions.user share resolve reopen invite".split(" "),a.action):!1},getIconClassName:function(a){var b=a.action;-1!==b.indexOf("task")&&(b="inline-task");_.include(["mentions.user","share","invite"],b)&&(b=a.entity);return b},main:function(){return this.models},unread:function(){return this.filter(function(a){return!a.get("read")})},setNotificationsAsRead:function(a,b){a=_(a).chain().filter(function(d){return!d.get("read")}).map(function(d){d.set("read",
!0,{silent:b});return d.id}).value();0<a.length&&MW.$.ajax({url:MW.contextPath+"/rest/mywork/latest/notification/read",type:"PUT",contentType:"application/json",data:JSON.stringify(a)})},getByAggregateKeyDeferred:function(a,b){var d=this;this.hasFetched.done(function(){b(d.getByAggregateKey(a))})},getByAggregateKey:function(a){return this.find(function(b){return b.get("aggregateKey")===a})},setStatusByGlobalId:function(a,b){this.each(function(d){d.setStatusByGlobalId(a,b)})},drilldown:function(a){return this.filter(function(b){return b.get("aggregateKey")==
a})},focused:function(a){return this.find(function(b){return b.get(a)})},focusMain:function(a,b){b=this.main(b);return"up"==a?this.focusPrevious(b,"mainFocused","removeMainFocused"):this.focusNext(b,"mainFocused","removeMainFocused")},setFocused:function(a){this.globalEvents.trigger("removeMainFocused");a.set("mainFocused",!0)},focusNext:function(a,b,d){var e=_.indexOf(a,this.focused(b));return e<a.length-1?(d?this.globalEvents.trigger(d):currentView[e].set(b,!1),a[e+1].set(b,!0),!0):!1},focusPrevious:function(a,
b,d){var e=_.indexOf(a,this.focused(b));return 0<e?(d?this.globalEvents.trigger(d):a[e].set(b,!1),a[e-1].set(b,!0),!0):!1},countNested:function(a){var b=0;_(a).each(function(d){b+=d.get("notifications").length});return b}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/views/task-view.js' */
MW.TaskAbstractView=Backbone.View.extend({tagName:"li",className:"task",events:{"click .item-content":"showDetail","click .mw-task-text":"showDetail","click .mw-drilldown-arrow":"showDetail","click .mw-task-checkbox":"toggleStatus"},initialize:function(a){this.globalEvents=a.globalEvents;this.model.bind("change",this.render,this);a.globalEvents.bind("reordered",this.reordered,this)},showDetail:function(){this.globalEvents.trigger("showTaskDetail",this.model)},toggleStatus:function(){this.model.isCompleted()?
this.model.setState("TODO"):this.model.setState("DONE")},reordered:function(a,b){this.model.cid===a&&(a=this.model,b=MW.Tasks.getByCid(b),MW.Tasks.reorder(a,b))},getDisplayText:function(){var a=this.model.get("title");a||(a="");return a},render:function(){var a=this.$el,b=this.getDisplayText(),c=/(^|\s)#(\w+)/g,d=b.match(c);b=this.parseTagText(b,c);this.renderTemplate(a,b);this.renderTagLozenge(d);this.model.isCompleted()?a.addClass("completed"):a.removeClass("completed");return this}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/views/notification-view.js' */
MW.NotificationAbstractView=Backbone.View.extend({tagName:"li",className:"mw-notification-item",events:{mousedown:"renderDrilldownClick",focus:"setFocusedItem"},initialize:function(a){this.globalEvents=a.globalEvents;this.globalEvents.bind("renderDrilldown",this.renderSpecifiedDrilldown,this);this.model.bind("change",this.render,this);_.bindAll(this,"renderSpecifiedDrilldown")},setFocusedItem:function(){this.globalEvents.trigger("removeMainFocused");this.model.set("mainFocused",!0)},render:function(){var a=
MW.$(this.el);a.attr("tabindex",0);a.attr("role","option");a.toggleClass("unread",this.model.hasNewNotifications());a.toggleClass("focused",this.model.get("mainFocused")||!1);this.model.get("pinned")&&a.addClass("pinned");this.renderTemplate(a);this.updateTitle();return this},renderDrilldownClick:function(){this.globalEvents.trigger("renderDrilldown",this.model,!1)},renderSpecifiedDrilldown:function(a,b,d){this.model.get("aggregateKey")==a.get("aggregateKey")&&this.renderDrilldown(b,d)},renderDrilldown:function(a,
b){b=new MW.DrilldownView({model:this.model,globalEvents:this.globalEvents,reverseSlide:b});this.model.resetFocused(_(this.model.getUnreadNotifications()).last());this.renderDrilldownTemplate(b,a);this.globalEvents.trigger("removeMainFocused");this.model.set("mainFocused",!0);MW.Notifications.setNotificationsAsRead(this.model.notifications,!0);this.updateTitle();this.$el.removeClass("unread")},updateTitle:function(){var a=this.$el.find(".mw-notification-text"),b=this.model.notifications,d=this.model,
f=_.filter(b,function(g){return!g.get("read")}).length,c="",e=this.model.get("title")||b[0].get("title")||"";1===b.length?c=d.i18nWithMap("title",{title:e}):(c=d.i18ns("aggregate",b.length,e),f&&(c=d.i18ns("aggregatenew",f,e)||c));a.text(c||e).attr("title",c)}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/views/notification-main-view.js' */
MW.NotificationMainAbstractView=Backbone.View.extend({className:"mw-notifications card",events:{"click .mw-show-more":"showMoreNotificationsEvent","click .mw-button-tasks":"gotoTasks"},initialize:function(a){this.globalEvents=a.globalEvents;this.globalEvents.on("showNotificationCard",this.showCard,this);this.globalEvents.bind("highlightNotificationAbove",this.highlightNotificationAbove,this);this.globalEvents.bind("highlightNotificationBelow",this.highlightNotificationBelow,this);this.globalEvents.bind("unblockKeyboardShortcut",
this.syncFocusPosition,this);MW.Notifications.bind("reset",this.addNotificationsToContainer,this);MW.Notifications.bind("remove",this.addNotificationsToContainer,this);MW.Notifications.bind("add",this.addOneNewNotification,this);MW.Notifications.bind("modified",this.updateNotification,this);a=MW.KeyboardShortcuts.setupContext("notification","showNotificationCard",this);a.addShortcut(107,this.highlightNotificationBelow);a.addShortcut(106,this.highlightNotificationAbove);a.addShortcut(13,this.renderFocusedDrilldown)},
syncFocusPosition:function(){var a=MW.$(this.el).find(".focused");a[0]&&a[0].focus()},cleanUp:function(){MW.Notifications.off()},renderFocusedDrilldown:function(){MW.App.globalEvents.trigger("renderDrilldown",MW.Notifications.focused("mainFocused"))},highlightNotificationAbove:function(){MW.Notifications.focusMain("down",this.isShowingAll())?MW.App.scrollToFocusedMain():this.showMoreNotifications("keyboard");this.syncFocusPosition()},highlightNotificationBelow:function(){MW.Notifications.focusMain("up",
this.isShowingAll());MW.App.scrollToFocusedMain();this.syncFocusPosition()},isShowingAll:function(){return!MW.$(".mw-show-more").filter(":visible").length},render:function(){var a=MW.$(this.el);this.renderTemplate(a);this.notificationList=a.find(".mw-notifications-list");return this},addNotificationsToContainer:function(){var a=this.notificationList,b=MW.Notifications.main();a.empty();0===b.length?this.renderEmptyNotificationsTemplate(a):this.addAllNotifications(b);var c=MW.$(MyWork.Templates.showMore());
MW.Notifications.countNested(b)<MW.MAX_RESULTS&&c.addClass("hidden");a.append(c)},addAllNotifications:function(a){var b=this;_.each(a,function(c){b.addOneNewNotification(c)})},updateNotification:function(a){setTimeout(_.bind(function(){var b=this.notificationList.find('li[aggregate-key\x3d"'+a.get("aggregateKey")+'"]');this.addOneNotification(a,b)},this))},addOneNewNotification:function(a){this.$el.find(".mw-no-notifications").remove();var b=new MW.NotificationView({model:a,globalEvents:this.globalEvents,
attributes:{"aggregate-key":a.get("aggregateKey")}});this.addOneNotification(a,b.render().$el)},addOneNotification:function(a,b){var c=this.$el.find(".mw-notifications-list");a=MW.Notifications.indexOf(a);a=c.find(".mw-notification-item").eq(a);0===a.length?c.append(b):a[0]!==b[0]&&a.before(b)},showMoreNotificationsEvent:function(a){this.showMoreNotifications("click");a.preventDefault()},showMoreNotifications:function(a){var b=MW.$(".more-trigger"),c=MW.$('\x3cli class\x3d"mw-loading-more" /\x3e');
b.before(c);b.addClass("hidden").remove();var h=_.bind(function(d,e){c.remove();d=_(e).reduce(function(f,g){return f+g.notifications.length},0);this.notificationList.append(b);d===MW.MAX_RESULTS&&b.removeClass("hidden")},this);MW.Notifications.fetchWithLimit({add:!0,data:{before:MW.Notifications.beforeId},success:h});this.fireShowMoreAnalyticsEvent(a)},fireShowMoreAnalyticsEvent:function(a){AJS.EventQueue.push({name:"mywork.showmore",properties:{count:MW.Notifications.main().length,from:a||"click"}})},
gotoTasks:function(){this.globalEvents.trigger("showTaskCard",1)}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/views/notification-entry-view.js' */
MW.NotificationEntryAbstractView=Backbone.View.extend({className:"mw-drilldown-list",events:{click:"focusSelected","click .authorise":"authorise","click .discard":"discard"},initialize:function(a){this.globalEvents=a.globalEvents;this.model.bind("change drilldownFocused",this.rerenderFocus,this)},cleanup:function(){this.model.off(null,null,this)},render:function(){var a=MW.$(this.el),b=this.model;a.toggleClass("focused",b.get("drilldownFocused")||!1);b.get("read")&&a.addClass("collapsed");var c=this.createNotificationTitle(b);
this.renderTemplate(a,{notification:b.toJSON(),htmlTitle:c});this.fixRelativeUrls();MW.Notifications.isMyWorkAuth(b.get("parent").attributes)&&a.find(".mw-drilldown-excerpt").append(MW.$('\x3cbutton class\x3d"authorise"\x3e'+"Authorize"+'\x3c/button\x3e\x3cbutton class\x3d"discard"\x3e'+"Discard"+"\x3c/button\x3e"));this.ensureNoMissingImage(a.find(".mw-drilldown-avatar"),"useravatar");this.actionMessageView=
new MW.ActionMessageView({el:a.find(".message")[0],aggregateKey:b.get("parent").get("aggregateKey")});this.addActions();return this},fixRelativeUrls:function(){var a=this.model.get("parent").config.getUrl().split("/",3).join("/");this.$el.find("a").each(function(b,c){(b=MW.$(c).attr("href"))&&0===b.indexOf("/")&&MW.$(c).attr("href",a+b)})},rerenderFocus:function(){MW.$(this.el).toggleClass("focused",this.model.get("drilldownFocused")||!1)},focusSelected:function(){this.globalEvents.trigger("focusClickedNotification",
this.model)},htmlTitle:function(){var a=this.model.get("parent").entityI18n("this")||"this";a=MW.$.extend({title:a},this.model.get("metadata"));return this.model.get("parent").i18nHtml("title",a)||MW.escapeHTML(this.model.get("title"))},ensureNoMissingImage:function(a,b){a.on("error",function(){var c=MW.$("\x3cspan /\x3e");c.addClass(b);a.after(c);a.remove()})},addActions:function(){var a=MW.$(this.el),b=this.model,c=a.find(".mw-drilldown-actions ul"),d=a.find(".action-form"),
e=b.get("actions").reverse(),f=this;MW.$.each(e,function(g,h){MW.Configurations.getFromNotification(b.attributes)&&(g=new MW.ActionView({model:h,url:b.get("url"),itemUrl:b.get("parent").get("url"),actionFormElement:d,notification:b,actions:e,target:"notification",actionMessageView:f.actionMessageView,globalEvents:f.globalEvents}),c.prepend(g.render().el))});e.reverse();this.addTime(c,b.getPrettyTime())},authorise:function(){window.top.location.href=this.model.get("url")},discard:function(){var a=
this.model;a.executeInlineAction({actionName:"dismissAuth",target:"notification",success:function(b){b.successful?(MW.Tasks.remove(MW.Tasks.getByGlobalId(a.get("globalId"))),MW.Notifications.remove(a.get("parent")),MW.App.gotoMain()):(b="Unknown error",this.actionMessageView.showErrorMessage(b))},error:function(b,c,d){401===b.status?this.actionMessageView.showLoginErrorMessage("You are not logged in. Please \u003ca href=\u0022#\u0022\u003elog in\u003c/a\u003e."):this.actionMessageView.showErrorMessage(d)}})}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/views/drilldown-view.js' */
MW.DrilldownAbstractView=Backbone.View.extend({className:"mw-notification-drilldown card",events:{"click .mw-drilldown-top":"gotoMain","click .mw-header .nav button":"gotoMain"},initialize:function(a){this.globalEvents=a.globalEvents;this.reverseSlide=a.reverseSlide;this.globalEvents.bind("showNotificationDrilldownCard",this.showCard,this);this.globalEvents.bind("movetoDrilldownAbove",this.movetoDrilldownAbove,this);this.globalEvents.bind("movetoDrilldownBelow",this.movetoDrilldownBelow,this);this.globalEvents.bind("cleanupNestedCard",
this.removeElementAndBindings,this);a=MW.KeyboardShortcuts.setupContext("notificationDrilldown-"+this.model.get("aggregateKey"),"showNotificationDrilldownCard",this);a.addShortcut(13,this.openDrilldownObject);a.addShortcut(106,this.gotoAboveNotification);a.addShortcut(107,this.gotoBelowNotification);a.addShortcut(110,this.movetoDrilldownBelow);a.addShortcut(112,this.movetoDrilldownAbove);a.addShortcut(115,this.createTaskFromDrilldown);a.addShortcut(117,this.gotoMain);this.kb=a},gotoAboveNotification:function(){this.globalEvents.trigger("highlightNotificationAbove");
this.renderDrilldown(!1)},gotoBelowNotification:function(){this.globalEvents.trigger("highlightNotificationBelow");this.renderDrilldown(!0)},renderDrilldown:function(a){var b=MW.Notifications.focused("mainFocused");this.model!=b&&this.globalEvents.trigger("renderDrilldown",b,!1,a)},createTaskFromDrilldown:function(){this.headerView.createTask()},movetoDrilldownAbove:function(){var a=this.model.focused(),b=this.model.focusOlder();a===b?MW.App.scrollToDrilldownHeader():(MW.App.scrollToFocusedDrilldown(),
_(this.collapsedGroup).contains(b)&&this.showOlder(function(){MW.App.scrollToFocusedDrilldown()}))},movetoDrilldownBelow:function(){this.model.focusNewer();MW.App.scrollToFocusedDrilldown()},openDrilldownObject:function(){var a=this.model.focused().get("url");window.open(a).opener=null},render:function(){var a=MW.$(this.el),b=this,e=this.model,f=this.model.notifications;this.renderTemplate(a);var h=a.find(".mw-drilldown-header"),g=a.find(".mw-drilldown-body");this.collapsedGroup=_.filter(f,function(c){return c.get("read")});
var d=this.collapsedGroup.length;this.headerView=new MW.HeaderView({el:h[0],model:e,numUpdates:f.length-d,globalEvents:this.globalEvents});this.headerView.render();this.entryViews=[];_.each(f,function(c){c=new MW.NotificationEntryView({model:c,globalEvents:b.globalEvents,attributes:{"notification-id":c.get("id")}});g.prepend(c.render().el);b.entryViews.push(c)});e=a.find(".mw-drilldown-list.collapsed");d===f.length&&(--d,e.last().removeClass("collapsed"),e=a.find(".mw-drilldown-list.collapsed"));
e.wrapAll("\x3cdiv class\x3d'collapsed-group'/\x3e");d&&(g.prepend("\x3cdiv class\x3d'mw-collapsed-header'\x3e\x3c/div\x3e"),a=g.find(".mw-collapsed-header"),a.click(function(c){setTimeout(function(){b.showOlder(function(){b.model.focusOldest()})},0);c.preventDefault()}),d=this.model.i18ns("older",d),a.html("\x3ca href\x3d'#'\x3e"+d+"\x3c/a\x3e"));return this},showOlder:function(a){var b=this.$el.find(".mw-collapsed-header");0!==b.length&&(this.showCollapsedGroup(MW.$(".collapsed-group"),a),b.remove())},
gotoMain:function(){this.globalEvents.trigger("showNotificationCard")},removeElementAndBindings:function(){this.$el.hasClass("showing")||(this.globalEvents.off(null,null,this),this.kb.cleanup(),this.headerView.removeBindings(),_.each(this.entryViews,function(a){a.cleanup()}),this.undelegateEvents(),this.remove())},showCard:function(a){this.$el.hasClass("showing")||(MW.Router.navigateToNotification(this.model.get("aggregateKey")),this.reverseSlide?this.showCardAnimationReverseSlide(a):this.showCardAnimation(a))}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/views/taskdetail-view.js' */
MW.TaskDetailAbstractView=Backbone.View.extend({tagName:"div",className:"mw-taskdetail card",events:{"click .mw-drilldown-top":"gotoTasks","click .mw-taskdetail-save":"gotoTasks","click .mw-header .nav button":"gotoTasks","keypress .mw-taskdetail-notes-textarea":"handleNotesKeypress","keypress .mw-taskdetail-title":"handleTitleKeypress","click .mw-taskdetail-notes":"editNotes","mousedown .mw-taskdetail-notes":"mouseNotes","focus .mw-taskdetail-notes":"focusNotes","focusout .mw-taskdetail-notes-textarea":"saveNotes",
"focusout .mw-taskdetail-title":"saveTitle","click .mw-taskdetail-delete":"deleteTask","click .mw-task-checkbox":"toggleCompleted"},initialize:function(a){this.globalEvents=a.globalEvents;this.globalEvents.bind("deleteTask",this.removeTask,this);this.globalEvents.bind("cleanupNestedCard",this.removeElementAndBindings,this);MW.KeyboardShortcuts.changeContext("taskDetail")},toggleCompleted:function(){this.completedCheckbox.hasClass("completed")?this.model.setState("TODO"):this.model.setState("DONE");
this.renderCompleteState()},showCard:function(a){MW.Router.navigateToTask(this.model.id);this.showCardAnimation(a)},handleNotesKeypress:function(a){a.stopPropagation();this.renderTags()},handleTitleKeypress:function(a){this.renderTags();13==a.keyCode&&(this.saveTitle(),a.preventDefault())},mouseNotes:function(){this.mouse=!0},focusNotes:function(){this.mouse||this.editNotes()},editNotes:function(){this.mouse=!1;this.notesTextareaDiv.hide();this.relatedContent.addClass("selected");var a=this.notesTextarea.val().length,
b=this.notesTextarea.show().focus()[0];b.setSelectionRange&&b.setSelectionRange(a,a)},saveNotes:function(){var a=this.notesTextarea.val();this.updateModel(function(){this.model.setNotes(a);this.updateNotes(a);this.notesTextarea.hide();this.notesTextareaDiv.show();this.relatedContent.removeClass("selected")})},updateNotes:function(a){var b=this.convertLinks(MW.$("\x3cpre /\x3e").text(a).html());b?this.notesTextareaDiv.removeClass("placeholder").html(b):this.notesTextareaDiv.addClass("placeholder").text("Add some notes");
this.notesTextarea.val(a)},convertLinks:function(a){var b=String.fromCharCode(160);return a.replace(/ {2}/g,b+b).replace(/\n/g,"\x3cbr /\x3e").replace(/(\b(https?|ftp|file):\/\/[\-A-Z0-9+&@#\/%?=~_|!:,.;]*[\-A-Z0-9+&@#\/%=~_|])/ig,"\x3ca href\x3d'$1' target\x3d'_blank'\x3e$1\x3c/a\x3e")},saveTitle:function(){this.updateModel(function(){this.model.setTitle(this.getTitleText())})},updateModel:function(a){_.bind(a,this)()},deleteTask:function(a){a.preventDefault();this.showDeleteConfirmation()},removeTask:function(){this.model.destroy();
this.globalEvents.trigger("showTaskCardBack")},getTitleText:function(){return this.titleInput.val()||this.titleInput.text()},getNotesText:function(){return this.model.get("notes")||""},gotoTasks:function(){this.saveTitle();this.saveNotes();this.globalEvents.trigger("showTaskCardBack")},removeElementAndBindings:function(){this.$el.hasClass("showing")||(this.model.off(null,null,this),this.globalEvents.off(null,null,this),this.undelegateEvents(),this.remove())},render:function(){var a=MW.$(this.el),
b=0===a.children().length;b&&this.renderTemplate(a);this.titleInput=a.find(".mw-taskdetail-title");this.notesTextarea=a.find(".mw-taskdetail-notes-textarea");this.notesTextareaDiv=a.find(".mw-taskdetail-notes");this.relatedContent=a.find(".mw-related-content");var c=this.getNotesText();this.updateNotes(c);b&&this.notesTextarea.hide();this.completedCheckbox=a.find(".mw-task-checkbox");this.container=a.find(".mw-taskdetail-container");this.renderTagPlaceholder();this.renderCompleteState();this.model.get("readonlyTitle")&&
this.titleInput.attr("title","Open the page to edit the task");this.relatedContent.attr("title","Open related link");return this},renderCompleteState:function(){var a=this.model.isCompleted();this.completedCheckbox.toggleClass("completed",a);this.container.toggleClass("completed",a)},renderTagPlaceholder:function(){AJS.DarkFeatures&&AJS.DarkFeatures.isEnabled("nat.tags")&&(MW.$(".mw-taskdetail-container").append(MyWork.Templates.taskDetailTags({task:this.model.attributes})),
this.renderTags())},renderTags:function(){if(AJS.DarkFeatures&&AJS.DarkFeatures.isEnabled("nat.tags")){var a=this.getTitleText(),b=this.notesTextarea.val();a=(a+" "+b).match(/(^|\s)#(\w+)/g);var c=MW.$(this.el).find(".mw-taskdetail-taglist");c.empty();a?(c.removeClass("empty"),_.each(a,function(d){c.append(MyWork.Templates.categoryLabel({text:d.split("#")[1]}))})):(c.addClass("empty"),c.text("Organize your tasks by adding a #tag"))}},isInlineTask:function(){return"com.atlassian.confluence"===
this.model.get("application")&&"inline-task"===this.model.get("entity")}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/views/task-main-view.js' */
MW.TaskMainAbstractView=Backbone.View.extend({tagName:"div",className:"mw-tasks card",completed:!1,events:{"keypress #new-personal-task":"createOnEnter","keyup #new-personal-task":"disableAddTask","input #new-personal-task":"disableAddTask","click .add-task":"addPersonalTask","click .view-completed":"toggleCompleted","click .mw-button-notifications":"gotoNotifications","click .view-completed-mobile":"showCompleted","click .view-uncompleted-mobile":"showUncompleted"},gotoNotifications:function(){this.globalEvents.trigger("showNotificationCard",
1)},initialize:function(a){this.globalEvents=a.globalEvents;this.globalEvents.bind("addPersonalTask",this.addPersonalTask,this);this.globalEvents.bind("showTaskDetail",this.showTaskDetail,this);this.globalEvents.bind("showTaskByGlobalId",this.showTaskByGlobalId,this);this.globalEvents.bind("showTaskCard",this.showTaskCard,this);this.globalEvents.bind("showTaskCardBack",this.showCard,this);MW.Tasks.bind("fetch",this.loaded,this);MW.KeyboardShortcuts.setupContext("task","showTaskCard",this);MW.$(document).bind("keydown",
_.bind(this.focusInput,this))},cleanUp:function(){MW.Tasks.off()},focusInput:function(){this.input.focus()},showTaskByGlobalId:function(a){this.showTaskDetail(MW.Tasks.getByGlobalId(a))},showTaskDetail:function(a,b){a=new MW.TaskDetailView({model:a,globalEvents:this.globalEvents});this.renderShowTaskDetailView(a,b);a.showCard()},showTaskCard:function(a){this.completed=!1;this.showCard(a)},addTodo:function(){if(this.taskList){var a=this;this.taskList.empty();var b=MW.Tasks.todo();0===b.length?this.renderEmptyTaskTemplate(this.taskList):
(_.each(b,function(c){a.addOneTask(c)}),this.makeTasksSortable());this.viewCompleted&&this.viewCompleted.toggle(0!==MW.Tasks.done().length)}},render:function(){var a=MW.$(this.el);this.renderTemplate(a);this.input=a.find("#new-personal-task");this.viewCompleted=a.find(".view-completed");this.addTask=a.find(".add-task");this.taskList=a.find(".mw-tasks-list");this.disableAddTask();return this},showLoading:function(){this.taskList.empty();(new ConfluenceMobile.Notification(this.taskList)).showLoading()},
loaded:function(){this.completed?this.addDone():this.addTodo()},addOneTask:function(a,b){MW.$(".mw-no-tasks").hide();a=new MW.TaskView({model:a,globalEvents:this.globalEvents,attributes:{"task-cid":a.cid}});b?this.taskList.prepend(a.render().el):this.taskList.append(a.render().el)},createOnEnter:function(a){13==a.which&&this.addPersonalTask()},addPersonalTask:function(){var a=this.input.val();MW.$.trim(a)&&(this.completed&&this.showUncompleted(),this.createPersonalTask(a).set("displayName",a),this.taskList.scrollTop(0),
this.input.val(""),this.disableAddTask())},createPersonalTask:function(a){a=MW.Tasks.create({application:"com.atlassian.mywork.host.provider",entity:"notes",status:"TODO",title:a},{at:0});this.addOneTask(a,!0);return a},show:function(){"resolved"===MW.Tasks.hasFetched.state()&&(this.completed?this.showCompleted():this.showUncompleted())},toggleCompleted:function(){this.completed?this.showUncompleted():this.showCompleted()},addDone:function(){this.taskList.empty();if(0===MW.Tasks.done().length)this.renderEmptyCompletedTemplate(this.taskList);
else{var a=new Date,b=new Date(a.getFullYear(),a.getMonth(),a.getDate());a=new Date(a.getFullYear(),a.getMonth(),a.getDate()-1);this.addListWithCategory(MW.Tasks.doneNewerThan(b),"Today");this.addListWithCategory(MW.Tasks.doneBetween(a,b),"Yesterday");this.addListWithCategory(MW.Tasks.doneOlderThan(a),"Older")}},addListWithCategory:function(a,
b){var c=this;a.length&&(this.taskList.append(MyWork.Templates.completedCategory({category:b})),_.each(a,function(d){c.addOneTask(d)}))}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/views/action-message-view.js' */
MW.ActionMessageView=Backbone.View.extend({showErrorMessage:function(a){a||(a="Oh no! Something\u0027s gone wrong. Check your network connection and try again.");this.$el.text(a)},showLoginErrorMessage:function(a){this.$el.html(a);this.$("a").click(function(b){b.preventDefault();"mobile"===MW.App.parseView()?ConfluenceMobile.loadLoginScreen(!0):location.reload()})},showOAuthErrorMessage:function(a,b){var c=MW.createCallback(MW.getBaseUrl(),this.options.aggregateKey);c&&(b+=MW.appendCallback(b,c));this.$el.html(a);this.$("a").attr("href",
b)},clearMessage:function(){this.$el.empty()}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/views/action-view.js' */
MW.ActionAbstractView=Backbone.View.extend({tagName:"li",className:"action-item",disabled:!1,events:function(){return{click:"clickEvent"}},disableFormElements:function(){this.options.actionFormElement.find("input").addClass("disabled").prop("disabled",!0)},enableFormElements:function(){this.options.actionFormElement.find("input").removeClass("disabled").prop("disabled",!1)},showSuccessMessage:function(a){var b=this.model.attrs||{};if(b.alternateAction)a=this.model,this.model=b.getAlternateAction(),
this.options.actions[_.indexOf(this.options.actions,a)]=this.model,this.render();else{b.allowOnceOnly&&this.disableActionElement();var c=this.actionI18n("alternateDisplayName");c&&this.toggleDisplayName(this.actionI18n("displayName"),c,b.responseLink);b.responseLink&&this.$el.unbind().find("a").attr("target","_blank").attr("href",a)}},makeAjaxRequest:function(a,b,c){var d=this,e=this.model.attrs||{},g=this.options.actionFormElement,h=d.options.actionMessageView;this.disableActionElement();g.find(".aui-button-primary").addClass("disabled");
g.find(".mw-loading").addClass("show");var k=this.addDots(),l=function(){k();d.enableActionElement();g.find(".aui-button-primary").removeClass("disabled");g.find(".mw-loading").removeClass("show")},n=function(f){l();h.clearMessage();g.parent().removeClass("expanded");a?a(f):d.showSuccessMessage(f)};this.options.notification.executeInlineAction({actionName:this.model.id,target:this.options.target,extraData:c,success:function(f){if(f.successful)e.instant||n();else{l();var m=d.i18n(f.messageKey)||f.message||
"Unknown error";b?b(m,null,f.authUrl):f.authUrl?h.showOAuthErrorMessage("Authorization failed. Please \u003ca\u003eauthorize\u003c/a\u003e.",f.authUrl):h.showErrorMessage(m)}},error:function(f,m,p){l();b?b(p,f):401===f.status?h.showLoginErrorMessage("You are not logged in. Please \u003ca href=\u0022#\u0022\u003elog in\u003c/a\u003e."):h.showErrorMessage(p)}});e.instant&&n()},addDots:function(){var a=MW.$(this.el).find("a"),b=a.text();a.text(b+"...");return function(){a.text(b)}},clickEvent:function(a){var b=
this.model.type;if(this.disabled)return!1;"link"!==b&&"taskLink"!==b&&a.preventDefault();"ajax"===b&&this.makeAjaxRequest(null,null,null);"form"===b&&(a=this.options.actionFormElement,a.find("form").remove(),a.append(this.renderForm()),a.parent().addClass("expanded"),this.showForm(a))},toggleDisplayName:function(a,b,c){c?c=MW.$(this.el).find("a"):(c=MW.$(this.el),c.unbind());a=c.text()===a?b:a;c.text(a)},disableActionElement:function(){this.setDisabled(!0)},enableActionElement:function(){this.setDisabled(!1)},
setDisabled:function(a){this.disabled=a;MW.$(this.el).toggleClass("disabled",a)},removeForm:function(){var a=this.options.actionFormElement;a.filter(":visible").length&&(a.find("textarea").blur(),a.remove(),this.enableActionElement())},doFormBindings:function(a){var b=this;a.keypress(function(d){d.stopPropagation()});var c=function(){var d=a.find(".aui-button-primary"),e=0<a.find("textarea").val().length;d.toggleClass("disabled",!e);e?d.prop("disabled",!1):d.prop("disabled",!0)};a.keyup(c);c();a.find(".inline-cancel").click(function(d){d.preventDefault();
b.removeForm()});a.submit(function(d){b.disableFormElements();d=a.serializeObject();a.find("textarea").blur().prop("disabled",!0);b.makeAjaxRequest(function(e){b.showSuccessMessage(e);b.removeForm()},function(e,g,h){var k=b.options.actionMessageView;a.find("textarea").prop("disabled",!1);g&&401===g.status?k.showLoginErrorMessage("You are not logged in. You may want to copy any changes you have made and \u003ca href=\u0022#\u0022\u003elog in\u003c/a\u003e again."):h?k.showOAuthErrorMessage("Authorization failed. You may want to copy any changes you have made and \u003ca\u003eauthorize\u003c/a\u003e.",h):k.showErrorMessage(e);
b.enableFormElements()},d);return!1})},renderForm:function(){this.disableActionElement();var a=this,b=this.getFormContainerTemplate(),c=MW.$(b);_.each(this.options.model.data,function(d){var e;"textarea"===d.type&&(e=a.getFormTextareaTemplate());c.append(e)});b=this.getFormActionButtonsTemplate({submitLabel:this.actionI18n("submitLabel")});c.append(b);this.doFormBindings(c);return c},render:function(){var a=MW.$(this.el);a.empty();if("link"===this.model.type){var b=this.options.notification,c=b.toJSON(),
d=this.options.url;this.model.url&&(d=MW.Configurations.getFromNotification(b.attributes),d=(d?d.get("url"):MW.contextPath)+MW.formatString(this.model.url,Mw.$.extend({globalId:c.globalId},c.metadata)));var e=this.actionI18n("displayName")||"Open";c=MW.$(MyWork.Templates.openLinkAction({notification:c,url:d,displayName:e}));c.mouseup(function(){b.get("parent").trigger("open",b)});a.append(c)}else"taskLink"===this.model.type?a.append(MW.$("\x3ca\x3e").attr("href",
this.options.url).attr("target","_blank").text(this.actionI18n("displayName"))):a.append(MW.$("\x3ca href\x3d'#'\x3e"+this.actionI18n("displayName")+"\x3c/a\x3e"));this.actionI18n("title")&&a.attr("title",this.actionI18n("title"));return this},actionI18n:function(a){return this.i18n("action."+this.model.id+"."+a)},i18n:function(a){var b=this.options.notification.toJSON(),c=b.parent.config;b=b.parent.get("application");return c.i18n(b+"."+a)}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/views/header-view.js' */
MW.HeaderAbstractView=Backbone.View.extend({events:{"click .mw-task":"selectTask"},initialize:function(b){this.globalEvents=b.globalEvents},removeBindings:function(){this.$el.unbind();this.model.off(null,null,this)},render:function(){var b=MW.$(this.options.el),a=this.options.model,c=this.htmlTitle();if(c){var d=a.has("globalId")&&!("com.atlassian.mywork.providers.confluence"===a.get("application")&&0===a.get("action").indexOf("task."))&&!a.get("pinned");c=MW.$.extend({},a.attributes,{title:c,newActionsText:this.newActionsText(),
renderTask:d,hasTask:a.hasTask()});this.renderTemplate(b,c,a);this.addActions()}},htmlTitle:function(){var b=this.model.notifications[0].get("metadata");return this.model.i18nHtml("itemtitle",b)||MW.escapeHTML(this.model.get("title"))},newActionsText:function(){var b=this.options.model,a=this.options.numUpdates,c=b.entityI18n("this")||"this",d=b.entityI18n("entity")||b.get("entity");c=c+" "+d;d=b.i18ns("aggregatenew",a,c);0===a&&(d=b.i18ns("aggregate",b.notifications.length,
c));return d},addActions:function(){var b=this,a=this.model,c=this.model.notifications[0],d=MW.$(this.options.el),f=MW.$(".drilldown-header-title \x3e .mw-drilldown-actions"),g=d.find(".mw-drilldown-actions \x3e ul"),h=new MW.ActionMessageView({el:d.find(".message")[0],aggregateKey:a.get("aggregateKey")});_.each(a.get("objectActions"),function(e){e=new MW.ActionView({model:e,url:a.get("url"),itemUrl:a.get("url"),actionFormElement:d.find(".action-form"),notification:c,actions:a.get("objectActions"),
actionMessageView:h,target:"object",actionElement:f,globalEvents:b.globalEvents});g.append(e.render().el)})},selectTask:function(){this.model.hasTask()?this.globalEvents.trigger("showTaskByGlobalId",this.model.get("globalId")):this.createTask()},_getRelatedTaskButton:function(){return MW.$(this.options.el).find(".drilldown-task-container .mw-task")},createTask:function(){this._getRelatedTaskButton().addClass("loading");this.model.createTask(_.bind(this.taskCreated,this))},taskCreated:function(){this._getRelatedTaskButton().removeClass("loading").addClass("on")}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/routes.js' */
MW.$(function(){MW.Router=Backbone.Router.extend({initialize:function(a){this.globalEvents=a.globalEvents},routes:{notification:"notifications",task:"tasks","notification/:id":"notification","task/:id":"task","*path":"initial"},navigateToMain:function(a){a=this.setDefaultOptions(a);this.navigate("notification",a)},navigateToNotification:function(a,b){b=this.setDefaultOptions(b);this.navigate("notification/"+a,b)},navigateToTasks:function(a){a=this.setDefaultOptions(a);this.navigate("task",a)},navigateToTask:function(a,
b){b=this.setDefaultOptions(b);this.navigate("task/"+a,b)},setDefaultOptions:function(a){a=a||{};_.extend(a,{replace:MW.$(".miniview-page").hasClass("iframe")});return a},initial:function(){MW.App.gotoInitial()},notifications:function(){MW.App.gotoMain()},tasks:function(){MW.App.gotoTasks()},notification:function(a){var b=this;MW.Notifications.getByAggregateKeyDeferred(a,function(c){if(_.isEmpty(c))return b.notifications();MW.Notifications.setFocused(c);b.globalEvents.trigger("renderDrilldown",c)})},
taskByGlobalId:function(a){MW.Tasks.getByGlobalIdDeferred(a,_.bind(this.task,this))},task:function(a){MW.Tasks.getByIdDeferred(a,_.bind(function(b){if(!b)return this.tasks();MW.App.completed=!b.isCompleted();this.globalEvents.trigger("showTaskDetail",b)},this))}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/views/miniview/notification-views.js' */
MW.NotificationMainView=MW.NotificationMainAbstractView.extend({renderEmptyNotificationsTemplate:function(a){a.html(MyWork.Templates.noNotifications({heading:"Hi!",subheading:"You don\u0027t have any notifications yet.",body:soydata.VERY_UNSAFE.ordainSanitizedHtml("\u003cp\u003eNew notifications will appear here when other users:\u003c/p\u003e\u003cul\u003e\u003cli\u003eShare content with you\u003c/li\u003e\u003cli\u003eMention you within a comment, page or blog\u003c/li\u003e\u003cli\u003eReply to or like any content you have created\u003c/li\u003e\u003c/ul\u003e")}))},renderTemplate:function(a){a.html(MyWork.Templates.mainNotification());a.find(".mw-button-notifications").toggleClass("on",
!0)},showCard:function(a){MW.Router.navigateToMain();MW.Cookie.save(!1);MW.CardAnimation.showCard(MW.$(this.el),MW.Slide.FROM_LEFT,a,function(){MW.App.scrollToFocusedMain()})}});
MW.NotificationView=MW.NotificationAbstractView.extend({initialize:function(){MW.NotificationView.__super__.initialize.apply(this,arguments);this.globalEvents.on("showNotificationCard",this.updateTime,this);this.globalEvents.on("reopenMiniview",this.updateTime,this);this.globalEvents.on("markAllRead",this.updateSeen,this)},updateTime:function(){this.$el.find(".mw-notification-time").text(this.model.getPrettyTime())},updateSeen:function(){MW.Notifications.setNotificationsAsRead(this.model.notifications,
!0);this.updateTitle();this.$el.removeClass("unread")},renderTemplate:function(a){a.html(MyWork.Templates.notificationView({notification:this.model.toJSON(),prettyTime:this.model.getPrettyTime()}))},renderDrilldownTemplate:function(a){MW.$("#mw-container").append(a.render().el);this.globalEvents.trigger("showNotificationDrilldownCard")}});
MW.NotificationEntryView=MW.NotificationEntryAbstractView.extend({createNotificationTitle:function(){return this.htmlTitle()},addTime:function(a,b){a.prepend(MW.$("\x3cli /\x3e").text(b))},renderTemplate:function(a,b){a.html(MyWork.Templates.drilldownEntry(b))}});MW.HeaderView=MW.HeaderAbstractView.extend({renderTemplate:function(a,b,c){a.html(MyWork.Templates.drilldownHeader(b));c.get("action")&&0===c.get("action").indexOf("task.")&&a.find(".drilldown-star-container").hide()}});
MW.DrilldownView=MW.DrilldownAbstractView.extend({renderTemplate:function(a){a.html(MyWork.Templates.notificationDrilldown())},showCardAnimation:function(a){MW.CardAnimation.showCard(MW.$(this.el),MW.Slide.FROM_RIGHT,a)},showCardAnimationReverseSlide:function(a){MW.CardAnimation.showCard(MW.$(this.el),MW.Slide.FROM_LEFT,a)},showCollapsedGroup:function(a,b){a.slideToggle(300,function(){a.focus();b&&b()})}});
MW.ActionView=MW.ActionAbstractView.extend({showForm:function(a){a.slideDown(100,function(){MW.App.scrollToFocusedElement(".mw-drilldown-container",".mw-notification-drilldown",a.parents(".mw-drilldown-list"));a.find("textarea").first().each(function(b,c){c.setSelectionRange&&(c.focus(),c.setSelectionRange(0,0))})})},renderForm:function(){var a=MW.ActionAbstractView.prototype.renderForm.apply(this,arguments);MW.makeTextAreaExpandable(a,function(){MW.App.scrollToFocusedElement(".mw-drilldown-container",
".mw-notification-drilldown",MW.$(".inline-action-submit"))});return a},getFormContainerTemplate:function(){return MyWork.Templates.inlineActionForm()},getFormTextareaTemplate:function(){return MyWork.Templates.inlineActionTextarea()},getFormActionButtonsTemplate:function(a){return MyWork.Templates.inlineActionSubmit(a)}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/views/miniview/deprecated-tasks-view.js' */
MW.DeprecatedTasksView=Backbone.View.extend({tagName:"div",className:"mw-tasks card",events:{"click .mw-button-notifications":"gotoNotifications","click #mw-deprecated-task-show-me":"closeAndShowFeatureDiscovery","click #mw-deprecated-task-dissmiss":"close"},initialize:function(a){this.globalEvents=a.globalEvents;this.globalEvents.bind("showTaskCard",this.showTaskCard,this);this.userMustMigrate="true"===MW.$("meta[name\x3d'mw-should-migrate-tasks']").attr("content")},render:function(){var a=MW.$(this.el);
this.renderTemplate(a);MW.Cookie.save(!1);return this},showTaskCard:function(a){this.completed=!1;this.showCard(a);this.migrateIfNeeded()},showCard:function(a){MW.Router.navigateToTasks();MW.CardAnimation.showCard(MW.$(this.el),MW.Slide.FROM_LEFT,a)},renderTemplate:function(a){a.html(MyWork.Templates.deprecatedTasks({userMustMigrate:this.userMustMigrate}));a.find(".mw-button-tasks").toggleClass("on",!0)},gotoNotifications:function(){this.globalEvents.trigger("showNotificationCard",1)},closeAndShowFeatureDiscovery:function(a){this.parentCloseAndDiscoverMyTasks();
a.preventDefault()},close:function(a){this.parentClose();a.preventDefault()},migrateIfNeeded:function(){var a=this;a.userMustMigrate?$.ajax({type:"POST",contentType:"application/json",data:{},url:MW.contextPath+"/rest/mywork/latest/task/migrateTasks"}).done(function(){a.userMustMigrate=!1;a.render()}):$.ajax({type:"POST",contentType:"application/json",data:{},url:MW.contextPath+"/rest/mywork/latest/task/hasInteracted"}).done(function(){a.userMustMigrate=!1;a.render()})},parentCloseAndDiscoverMyTasks:function(){window.parent.MW.Tasks.closeAndDiscoverMyTasks()},
parentClose:function(){window.parent.MW.Dialog.hide()}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/mywork.js' */
AJS.EventQueue=AJS.EventQueue||[];MW.MAX_RESULTS=parseInt(MW.getParameterByNameFromHash("max")||"0",10)||30;
MW.$(function(){var d=_.extend({},Backbone.Events);MW.globalEvents=d;MW.contextPath=MW.$("meta[name\x3dcontext-path]").attr("content");MW.configurationVersion=MW.$("meta[name\x3d'mw-configuration-version']").attr("content");MW.setRequestTime(MW.$("meta[name\x3d'mw-request-time']").attr("content"));MW.Configurations=new MW.ConfigurationCollection;MW.Notifications=new MW.NotificationCollection([],{globalEvents:d,config:MW.Configurations});MW.Tasks=new MW.TaskCollection([]);MW.KeyboardShortcuts=new MW.KeyboardShortcuts(d);
MW.CardAnimation=new MW.CardTransitions({globalEvents:d});MW.AppView=Backbone.View.extend({el:MW.$("#mw-container"),count:0,render:function(){},initialize:function(a){function e(b){MW.Notifications.fetcher({success:function(){AJS.EventQueue.push({name:"notificationtabopened",properties:{tasks:MW.Tasks.length,unread:b,loadedBy:MW.App.parseView()}});c.gotoInitial(b)}});MW.Tasks.fetchOnce();c.globalEvents.trigger("reopenMiniview")}var c=this;this.globalEvents=a.globalEvents;this.renderNotificationMain();
a="true"===MW.$("meta[name\x3d'mw-user-has-interacted-with-deprecated-task-mw']").attr("content");"true"!==MW.$("meta[name\x3d'mw-user-has-tasks-to-migrate']").attr("content")||a?MW.$(".mw-toggles.toolbar-group").addClass("hide"):this.renderDeprecatedTaskMain();MW.Notifications.bind("all",this.render,this);MW.Notifications.bind("open",this.openNotification,this);MW.Tasks.bind("all",this.render,this);MW.onJsonMessage(function(b){b.unread?e(b.unread):b.markAllRead&&c.globalEvents.trigger("markAllRead")});
MW.Configurations.fetchOnce().done(function(){MW.parentConfig.preload||(MW.Notifications.fetcher(),MW.Tasks.fetchOnce())});MW.Tasks.bind("destroy",function(b){MW.Notifications.setStatusByGlobalId(b.get("globalId"),"")})},renderNotificationMain:function(){var a=new MW.NotificationMainView({globalEvents:this.globalEvents});MW.$("#mw-container").append(a.render().el)},renderDeprecatedTaskMain:function(){var a=new MW.DeprecatedTasksView({globalEvents:d});MW.$("#mw-container").append(a.render().el)},gotoInitial:function(){"0"==
MW.parentConfig.unread&&MW.Cookie.load()?MW.$(".mw-tasks").is(":visible")||MW.App.gotoTasks(1):MW.$(".mw-notifications").is(":visible")||MW.App.gotoMain(1)},gotoTasks:function(){MW.Router.navigateToTasks();this.globalEvents.trigger("showTaskCard",1);this.gotoTasksOnce||(AJS.EventQueue.push({name:"tasktabopened",loadedBy:MW.App.parseView()}),this.gotoTasksOnce=!0);MW.Cookie.save(!0)},gotoMain:function(){MW.Router.navigateToMain();this.globalEvents.trigger("showNotificationCard",1);MW.Cookie.save(!1)},
parseView:function(){if(window.top===window.self)return"homepage";if(-1!=window.location.href.indexOf("anchorTarget\x3d_blank"))return"chrome"},scrollToFocusedElement:function(a,e,c){var b=MW.$(a);a=MW.$(e||a);c=c||MW.$(b).find(".focused");c.length&&(a=b.scrollTop()+c.position().top-a.position().top,b.scrollTop(Math.max(b.scrollTop(),a-b.height()+c.outerHeight(!0))),b.scrollTop(Math.min(b.scrollTop(),a)))},scrollToFocusedDrilldown:function(){this.scrollToFocusedElement(".mw-drilldown-container",".mw-notification-drilldown")},
scrollToFocusedMain:function(){this.scrollToFocusedElement(".mw-notifications-list")},scrollToDrilldownHeader:function(){this.scrollToFocusedElement(".mw-drilldown-container",".mw-drilldown-container",MW.$(".mw-drilldown-header"))},openNotification:function(a){AJS.EventQueue.push({name:"mywork.notificationlinkopened",properties:a.toEventJSON()})}});var f=function(){MW.App=new MW.AppView({globalEvents:d});MW.Router=new MW.Router({globalEvents:d});Backbone.history.start({root:MW.contextPath+"/plugins/servlet/"+
window.location.pathname.match(/servlet\/([^\/]*(?:\/m)?)?\/?/)[1]+"/"})};MW.parentConfig={};window.top!=window.self?(MW.$(".miniview-page").addClass("iframe"),MW.$("body").bind("click",function(a){a.stopPropagation()}),MW.onJsonMessage(function(a,e){a.parentConfig&&e.source===parent&&(MW.parentConfig=a.parentConfig,f())}),parent.postMessage("getParentConfig","*")):f()});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/kb-shortcuts.js' */
MW.KeyboardShortcuts=function(e){var b={},d={},k=!1;b.addShortcut=function(a,f,g,h){var c=d[g];c=c||{};c[a]=_.bind(f,h);d[g]=c};b.setupContext=function(a,f,g){var h=function(){b.changeContext(a)};e.on(f,h);return{cleanup:function(){e.off(f,h);d[a]={}},addShortcut:function(c,l){b.addShortcut(c,l,a,g)}}};b.changeContext=function(a){b.context=a};b.keyPressed=_.debounce(function(a){if(!k&&(a=(d[b.context]||{})[a]))return a(),!0},30);b.clearShortcuts=function(){d={}};(function(){MW.$(document).bind("keydown",
function(a){27==a.which&&parent.postMessage("escKey","*")});MW.$(document).bind("keypress",function(a){b.keyPressed(a.which)&&(a.preventDefault(),a.stopPropagation())});e.on("blockKeyboardShortcut",function(){k=!0});e.on("unblockKeyboardShortcut",function(){k=!1})})();return b};
}catch(e){WRMCB(e)};