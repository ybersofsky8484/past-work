WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'confluence.extra.livesearch:livesearch-macro-web-resources', location = 'templates/extra/livesearch/script/livesearch.js' */
AJS.toInit(function(l){var t={userinfo:"icon-user",personalspace:"icon-personal-space"},y=function(a){var b={title:a.title.replace(/&amp;/g,"\x26").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&lt;/g,"\x3c").replace(/&gt;/g,"\x3e"),link:[{type:"text/html",rel:"alternate",href:AJS.contextPath()+decodeURI(a.url)}],type:a.contentType};a.searchResultContainer&&(b.space={name:a.searchResultContainer.name});a.metadata&&a.metadata.cssClass&&(b.livesearchIconClass=a.metadata.cssClass);var f=a.contentType;
f&&t[f]&&(b.livesearchIconClass=t[f]);a.bodyTextHighlights&&(b.bodyTextHighlights=a.bodyTextHighlights);return b},u=function(a,b){a.after(a.clone().attr("class","additional").html(b));a.parent().addClass("with-additional")},v=function(a,b,f){return[{title:f,link:[{type:"text/html",rel:"alternate",href:AJS.params.baseUrl+"/dosearchsite.action?queryString\x3d"+a+"\x26where\x3d"+b}],iconClass:"search-for"}]};l(".search-macro-query input").each(function(){var a=l(this),b=a.closest("form"),f=b.find(".aui-icon.aui-iconfont-search"),
p=b.find("input[name\x3d'where']").val(),w=b.find("input[name\x3d'additional']").val(),x=b.find("input[name\x3d'labels']").val(),z=b.find("input[name\x3d'contentType']").val();a.quicksearch("/rest/searchv3/1.0/search",null,{ajsDropDownOptions:{className:"search-macro-dropdown",hideHandler:function(){a.focus();a.closest(".search-macro").find("div[aria-live]").text("")}},minLengthForGetData:3,dropdownPlacement:function(c){var d=b.siblings(".aui-dd-parent"),q=b.parent(".search-macro").position();d.css({position:"absolute",
top:q.top+a.outerHeight(),width:a.outerWidth()});c.width(a.outerWidth());d.append(c)},makeParams:function(c){return{queryString:c,where:p,labels:x?x.split(","):void 0,type:z,pageSize:5,highlight:!1,sessionUuid:"0-0-0-0"}},makeRestMatrixFromData:function(c){var d=a.val();return c.results&&c.results.length?(c=_.map(c.results,y),[c,v(d,p,AJS.format("See more results for \u0027\u0027{0}\u0027\u0027",d))]):(c=v(d,p,AJS.format("No results found for \u0027\u0027{0}\u0027\u0027",d)))?[c]:[]},dropdownPostprocess:function(c){const d=
c.closest(".search-macro"),q=d.find(".search-macro-query input"),m=d.find(".aui-dropdown"),A=(new Date).getTime(),k=c.find("ol:not(.last)").first().find("li");m.attr("id",A);l(".search-macro-dropdown ol").first().find("li").length;1<k.length?d.find("div[aria-live]").text(AJS.format("\u0027\u0027{0}\u0027\u0027 results were found, use the down arrow to browse the list. Use enter to select a link.",k.length)):0<k.length?d.find("div[aria-live]").text(AJS.format("\u0027\u0027{0}\u0027\u0027 result was found, use the down arrow to browse the list. Use enter to select a link.",k.length)):d.find("div[aria-live]").text(AJS.format("No results found",
k.length));q.on("keydown",function(e){9===e.which?m.hide():38!==e.which&&40!==e.which||setTimeout(()=>{m.find("li.active").focus()},0)});AJS.$("a",c).each(function(){var e=l(this),g=e.find("span"),r=e.parent("li"),h=AJS.dropDown.getAdditionalPropertyValue(g,"restObj");if(h&&h.livesearchIconClass){var B=AJS.dropDown.getAdditionalPropertyValue(g,"iconClass");e.removeClass(B);g.addClass(h.livesearchIconClass)}"space name"===w?(g=AJS.dropDown.getAdditionalPropertyValue(g,"spaceName"))&&!e.is(".content-type-spacedesc")&&
u(e,g):"page excerpt"===w&&h.bodyTextHighlights&&u(e,h.bodyTextHighlights);r.attr("data-content-type",h.type);r.attr("tabindex","0");r.on("keydown",function(n){9===n.which?n.preventDefault():38!==n.which&&40!==n.which||setTimeout(()=>{m.find("li.active").focus()},0)})})}});a.on({"quick-search-loading-start":function(){f.prepend('\x3caui-spinner size\x3d"small"\x3e\x3c/aui-spinner\x3e').removeClass("aui-iconfont-search")},"quick-search-loading-stop":function(){f.children("aui-spinner").remove();f.addClass("aui-iconfont-search")}})})});
}catch(e){WRMCB(e)};