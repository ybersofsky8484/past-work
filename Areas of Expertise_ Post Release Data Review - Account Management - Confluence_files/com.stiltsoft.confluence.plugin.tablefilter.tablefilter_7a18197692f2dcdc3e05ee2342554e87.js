WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:7a18197692f2dcdc3e05ee2342554e87', location = 'build/6424.js' */
"use strict";(self.webpackChunkcom_stiltsoft_confluence_plugin_tablefilter=self.webpackChunkcom_stiltsoft_confluence_plugin_tablefilter||[]).push([[6424],{4306:function(t,e,n){n.r(e),n.d(e,{SPREADSHEET_READY_MSG:function(){return r}});var r="spreadsheet-ready"},9685:function(t,e,n){n.r(e),n.d(e,{selectAutoSave:function(){return f},selectDisableEdit:function(){return u},selectMacroHeight:function(){return s},selectSaveAllVersions:function(){return d},selectSettings:function(){return p},selectShowSource:function(){return l},setSettings:function(){return c},settingsSlice:function(){return a},updateAutoSave:function(){return o}});var r=n(46776);const i={macroHeight:700,disableEdit:!1,autoSave:!1,saveAllVersions:!1},a=(0,r.createSlice)({name:"settings",initialState:i,reducers:{setSettings:(t,e)=>{const{payload:{settings:{macroHeight:n,disableEdit:r,showSource:a,autoSave:o,saveAllVersions:c},isCloud:s}}=e;t.macroHeight=s?+n||i.macroHeight:n?+n:"",t.disableEdit=r??i.disableEdit,a&&(t.showSource=a),t.autoSave=o??i.autoSave,t.saveAllVersions=c??i.saveAllVersions}}}),o=(0,r.createAction)("settings/updateAutoSave"),{setSettings:c}=a.actions,s=t=>t.settings.macroHeight,u=t=>t.settings.disableEdit,l=t=>t.settings.showSource,f=t=>t.settings.autoSave,d=t=>t.settings.saveAllVersions,p=t=>t.settings;e.default=a.reducer},19931:function(t,e,n){n.r(e),n.d(e,{getAttachmentData:function(){return I},getAttachmentInfo:function(){return O},getLatestAttachmentVersionInfo:function(){return A},searchContent:function(){return S},searchContentByCQL:function(){return h},searchPage:function(){return g},storeAttachment:function(){return b}});n(54802),n(6558),n(4267),n(63544);var r=n(27755),i=n(62896),a=n(89073),o=n(84109),c=n(32457),s=n(14412),u=n(76581),l=n(33210);function f(t,e,n,r,i,a,o){try{var c=t[a](o),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,i)}function d(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(t){f(a,r,i,o,c,"next",t)}function c(t){f(a,r,i,o,c,"throw",t)}o(void 0)}))}}function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(Object(n),!0).forEach((function(e){v(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function v(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var h=t=>new Promise((e=>{(0,i.makeRequest)({type:"GET",url:"/rest/api/content/search",contentType:"application/json",dataType:"text",data:t||{cql:""},success:function(t){e(t)},error:function(){e('{ "results": [] }')}})}));function y(t,e,n){var r="=",i=t;-1!==t.indexOf('"')&&(i=t.replace(/"/g,""),r="~");var a=n?"type = ".concat(n):s.CQL_CONTENT_TYPES_FILTER;return"".concat(a,' and space = "').concat(e,'" and title ').concat(r,' "').concat(i,'"')}var g=(t,e,n,r)=>{if(!t)return{id:n};var i={cql:y(t,e),limit:200};return r&&(i.expand=r),h(i).then((t=>JSON.parse(t).results)).then((e=>1===e.length?e[0]:e.find((e=>e.title===t))))},S=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"page",r=arguments.length>3?arguments[3]:void 0;if(!t)throw new Error("No page title");var i={cql:y(t,e,n),limit:200,type:n};return r&&(i.expand=r),h(i).then(JSON.parse).then((t=>t.results)).then((e=>1===e.length?e[0]:e.find((e=>e.title===t))))},b=t=>{var{context:e,data:n,filename:o,minorEdit:c}=t;return new Promise(((t,s)=>{try{var u=(0,r.getDataFromAttachmentName)(o,e.spaceKey),l=new Blob([n],{}),f=(0,a.getStoreAttachmentOpts)(l,u.attachmentName,c);(0,i.makeRequest)(m(m({},f),{},{url:"/rest/api/content/".concat(e.pageId,"/child/attachment?status=").concat(e.originStatus,"&allowDuplicated=true"),headers:{"X-Atlassian-Token":"nocheck"},success:e=>{t(JSON.parse(e))},error:t=>{s(new Error(t))}}))}catch(t){s(t)}}))},O=function(){var t=d((function*(t){var{attachmentContext:e,attachmentName:n}=t,{spaceKey:i,pageId:a}=e,{attachmentName:o}=(0,r.getDataFromAttachmentName)(n,i);return yield(0,l.getAttachments)(a,{filename:o,limit:1})}));return function(e){return t.apply(this,arguments)}}(),A=function(){var t=d((function*(t){var{attachmentContext:e,attachmentName:n}=t;if(!e)return null;var r=yield O({attachmentContext:e,attachmentName:n});return yield(0,c.getFormattedAttachmentVersion)(r)}));return function(e){return t.apply(this,arguments)}}(),I=function(){var t=d((function*(t,e){var{response:n,name:r,attachmentContext:i}=yield(0,u.getAttachmentsByPageContext)(t,e),a=n.results.find((t=>r===t.title));if(!a)throw new Error("Attachment not found.");var s=yield O({attachmentContext:i,attachmentName:r}),l=yield(0,c.getFormattedAttachmentVersion)(s);if(!l)throw new Error("Attachment version info not found.");var{data:f}=yield(0,o.default)(a._links.download,{parse:!0});return{data:f,context:i,attachmentVersionInfo:l,attachmentId:null==a?void 0:a.id}}));return function(e,n){return t.apply(this,arguments)}}()},27755:function(t,e,n){n.r(e),n.d(e,{getDataFromAttachmentName:function(){return r}});n(4267);var r=(t,e)=>{if(t.indexOf("^")>0){var n=t.split("^"),r=n[1],i=n[0],a=i.indexOf(":");a>0&&(e=i.substring(0,a),i=i.substring(a+1));var o=/\d{4}\/\d{2}\/\d{2}\//.test(i),c="";if(o){var s=i.split("/");i=s[3],c=s.slice(0,3).join("-")}return{attachmentName:r,pageTitle:i,spaceKey:e,postingDate:c,type:o?"blogpost":"page"}}return{attachmentName:t}}},32457:function(t,e,n){n.r(e),n.d(e,{getFormattedAttachmentVersion:function(){return r}});var r=t=>function(t){var{results:e}=t;if(!e.length)return null;var{version:n}=e[0];if(null==n||!n.by)return null;var{friendlyWhen:r,when:i,by:{displayName:a,profilePicture:{path:o}}}=n;return{when:i,friendlyWhen:r,updatedBy:{displayName:a,picture:o}}}(t)},33210:function(t,e,n){n.r(e),n.d(e,{getAttachments:function(){return c}});n(54802),n(63544);var r=n(41028);function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){o(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function o(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var c=(t,e)=>(0,r.makeGet)({url:"/rest/api/content/".concat(t,"/child/attachment"),data:a(a({},e),{},{expand:"version"})})},38204:function(t,e,n){n.r(e),e.default=function(t){return{pageId:t.id,spaceKey:t.space.key,type:t.type,originStatus:t.status}}},40636:function(t,e,n){n.r(e),n.d(e,{CLOSE_MODE:function(){return r},FLAG_TYPE:function(){return i},showErrorFlag:function(){return o},showInfoFlag:function(){return s},showMergeFlag:function(){return u},showSuccessFlag:function(){return c}});var r={MANUAL:"manual",AUTO:"auto"},i={INFO:"info",SUCCESS:"success",WARNING:"warning",ERROR:"error"},a=t=>{var{title:e,body:n,type:a=i.INFO,close:o=r.MANUAL}=t;n=AJS.escapeHtml(n);var c=AJS.flag({title:e,body:n,type:a,close:o});return o===r.AUTO&&setTimeout((()=>c.close()),15e3),c},o=t=>{var{title:e,body:n,close:o=r.MANUAL}=t;return a({title:e,body:n,close:o,type:i.ERROR})},c=t=>{var{title:e,body:n,close:o=r.MANUAL}=t;return a({title:e,body:n,close:o,type:i.SUCCESS})},s=t=>{var{title:e,body:n,close:o=r.MANUAL}=t;return a({title:e,body:n,close:o,type:i.INFO})},u=t=>{var{title:e,conflictAttachmentVersionInfo:n,close:i=r.AUTO}=t,{updatedBy:{displayName:a},when:o}=n,s=AJS.format("Added changes made by {0} on {1}",a,new Date(o).toLocaleString());return c({title:e,body:s,close:i})};e.default=a},41028:function(t,e,n){n.r(e),n.d(e,{makeDelete:function(){return s},makeGet:function(){return a},makePost:function(){return o},makePut:function(){return c}});var r=n(62896);const i=(t,e)=>{const n="GET"!==e&&t.data&&"string"!=typeof t.data,i={contentType:"application/json",dataType:"text",type:e,...t,data:n?JSON.stringify(t.data):t.data};return new Promise(((t,e)=>{(0,r.makeRequest)({...i,success:function(e){t(e?JSON.parse(e):e)},error:t=>e(t)})}))},a=t=>i(t,"GET"),o=t=>i(t,"POST"),c=t=>i(t,"PUT"),s=t=>i(t,"DELETE")},65368:function(t,e,n){n.r(e),n.d(e,{addToHistory:function(){return u},conflictStateSlice:function(){return a},hasHistory:function(){return b},initConflict:function(){return d},resetHistory:function(){return l},selectAttachmentId:function(){return A},selectAttachmentVersionDate:function(){return O},selectConflictAttachmentVersionInfo:function(){return I},selectConflictProfilePictureSrc:function(){return w},selectDataConflict:function(){return v},selectHistory:function(){return S},selectIsImported:function(){return y},selectIsSaving:function(){return g},selectIsUpdated:function(){return h},setAttachmentId:function(){return c},setAttachmentVersionDate:function(){return o},setConflictAttachmentVersionInfo:function(){return s},setIsImported:function(){return f},setIsOpened:function(){return p},setIsSaving:function(){return m}});var r=n(46776),i=n(44488);const a=(0,r.createSlice)({name:"conflictState",initialState:{date:null,id:"",conflictAttachmentVersionInfo:null,history:[],isUpdated:!1,isImported:!1,isSaving:!1},reducers:{addToHistory:(t,e)=>{t.isImported||t.history.push(...e.payload),t.isUpdated=!0},resetHistory:(t,{payload:e})=>{t.history=t.history.slice(e),t.isUpdated=0!==t.history.length,t.isImported=!1},setIsImported:t=>{t.isImported=!0,t.isUpdated=!0,t.history=[]},setIsOpened:t=>{t.isImported=!1,t.isUpdated=!0,t.history=[]},setIsSaving:(t,{payload:e})=>{t.isSaving=e},initConflict:(t,{payload:{history:e,isImported:n,isUpdated:r}})=>{t.history=e,t.isUpdated=r,t.isImported=n},setAttachmentVersionDate:(t,e)=>{const{payload:n}=e;t.date=n},setAttachmentId:(t,e)=>{const{payload:n}=e;t.id=n},setConflictAttachmentVersionInfo:(t,e)=>{const{payload:n}=e;t.conflictAttachmentVersionInfo=n}}}),{setAttachmentVersionDate:o,setAttachmentId:c,setConflictAttachmentVersionInfo:s,addToHistory:u,resetHistory:l,setIsImported:f,initConflict:d,setIsOpened:p,setIsSaving:m}=a.actions,v=t=>t.dataConflict,h=(0,i.createSelector)(v,(t=>t.isUpdated)),y=(0,i.createSelector)(v,(t=>t.isImported)),g=(0,i.createSelector)(v,(t=>t.isSaving)),S=(0,i.createSelector)(v,(t=>t.history)),b=(0,i.createSelector)(S,(t=>t.length>0)),O=(0,i.createSelector)(v,(t=>t.date)),A=(0,i.createSelector)(v,(t=>t.id)),I=(0,i.createSelector)(v,(t=>t.conflictAttachmentVersionInfo)),w=(0,i.createSelector)((t=>t.dataConflict.conflictAttachmentVersionInfo?.updatedBy?.picture),(t=>t.environment.baseURL),(t=>t.environment.isCloud),((t,e,n)=>n?e&&t?e+t:null:t));e.default=a.reducer},68183:function(t,e,n){n.r(e),n.d(e,{environmentSlice:function(){return a},resetExitOnSave:function(){return d},selectAiConfig:function(){return v},selectBaseURL:function(){return A},selectCanEdit:function(){return b},selectExitOnSave:function(){return O},selectFullscreenModeInCloud:function(){return S},selectIsCloud:function(){return h},selectIsExistingMacro:function(){return y},selectIsTemplate:function(){return I},selectIsViewMode:function(){return g},setAiConfig:function(){return o},setBaseURL:function(){return p},setCanEdit:function(){return l},setExitOnSave:function(){return f},setIsCloud:function(){return c},setIsExistingMacro:function(){return s},setIsTemplate:function(){return m},setIsViewMode:function(){return u}});var r=n(46776),i=n(44488);const a=(0,r.createSlice)({name:"environment",initialState:{aiConfig:{isAiUiDisabled:!1,aiEnabled:!0},isCloud:!1,isNewMacro:!0,isViewMode:!1,canEdit:!0,exitOnSave:!1,baseURL:"",isTemplate:!1},reducers:{setAiConfig:(t,{payload:e})=>{t.aiConfig=e},setIsCloud:(t,e)=>{const{payload:n}=e;t.isCloud=n},setIsExistingMacro:t=>{t.isNewMacro=!1},setIsViewMode:(t,e)=>{const{payload:n}=e;t.isViewMode=n},setCanEdit:(t,e)=>{const{payload:n}=e;t.canEdit=n},setExitOnSave:t=>{t.exitOnSave=!0},resetExitOnSave:t=>{t.exitOnSave=!1},setBaseURL:(t,e)=>{const{payload:n}=e;t.baseURL=n},setIsTemplate:(t,e)=>{const{payload:n}=e;t.isTemplate=n}}}),{actions:{setAiConfig:o,setIsCloud:c,setIsExistingMacro:s,setIsViewMode:u,setCanEdit:l,setExitOnSave:f,resetExitOnSave:d,setBaseURL:p,setIsTemplate:m}}=a,v=t=>t.environment.aiConfig,h=t=>t.environment.isCloud,y=t=>!t.environment.isNewMacro,g=t=>t.environment.isViewMode,S=(0,i.createSelector)(g,h,((t,e)=>!t&&e)),b=t=>t.environment.canEdit,O=t=>t.environment.exitOnSave,A=t=>t.environment.baseURL,I=t=>t.environment.isTemplate;e.default=a.reducer},76581:function(t,e,n){n.r(e),n.d(e,{getAttachmentsByPageContext:function(){return s}});n(6558);var r=n(38204),i=n(27755),a=n(33210),o=n(41028);function c(t,e,n,r,i,a,o){try{var c=t[a](o),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,i)}var s=function(){var t,e=(t=function*(t,e){var n=(0,i.getDataFromAttachmentName)(e,t.spaceKey);if(n.pageTitle){var c={expand:"space,children.attachment",spaceKey:n.spaceKey,title:n.pageTitle,postingDay:n.postingDate,type:n.type},s=(yield(0,o.makeGet)({url:"/rest/api/content",data:c})).results[0],u=s.children.attachment,l=(0,r.default)(s);return{response:u,name:n.attachmentName,attachmentContext:l}}return{response:yield(0,a.getAttachments)(t.pageId,{filename:e,limit:1}),name:e,attachmentContext:t}},function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(t){c(a,r,i,o,s,"next",t)}function s(t){c(a,r,i,o,s,"throw",t)}o(void 0)}))});return function(t,n){return e.apply(this,arguments)}}()},76631:function(t,e,n){n.r(e),n.d(e,{default:function(){return i}});var r=n(19931);function i(t,e){return(0,r.getAttachmentData)(t,e).catch((e=>(console.error(e),{context:t})))}},84109:function(t,e,n){n.r(e);n(6558);var r=n(62896);e.default=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{parse:!1};return new Promise(((n,i)=>{(0,r.makeRequest)({url:t,type:"GET",contentType:"application/json",success:t=>{n({data:e.parse?JSON.parse(t):t})},error:t=>{i(new Error(t))}})}))}},89073:function(t,e,n){n.r(e),n.d(e,{buildFilenameQuery:function(){return a},extractAttachmentContainerData:function(){return o},getStoreAttachmentOpts:function(){return c}});n(6558),n(4267),n(62708);var r=n(19931);function i(t,e,n,r,i,a,o){try{var c=t[a](o),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,i)}var a=(t,e)=>{var n=t?'title~"'.concat(t,'*" and '):"";return n+='(sitesearch~"file.extension:'+e.join('" or sitesearch~"file.extension:')+'")'},o=function(){var t,e=(t=function*(t,e){var n,i=t.content._expandable.space.replace("/rest/api/space/",""),a=t.resultParentContainer.title,o=t.content.title,c=null===(n=t.resultParentContainer.displayUrl.split(i+"/")[1])||void 0===n?void 0:n.match("\\d{4}/\\d{2}/\\d{2}");return c&&(a=c[0]+"/"+a),{wikiLink:o,parentPageId:yield(0,r.searchPage)(a,i,e),parentTitle:a,parentSpaceKey:i}},function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function c(t){i(o,r,a,c,s,"next",t)}function s(t){i(o,r,a,c,s,"throw",t)}c(void 0)}))});return function(t,n){return e.apply(this,arguments)}}(),c=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=new FormData;return r.append("file",t,e),r.append("minorEdit",n),{type:"POST",contentType:!1,processData:!1,dataType:"text",data:r}}},90823:function(t,e,n){n.r(e),n.d(e,{dialogStateSlice:function(){return r},selectConfirmationDialogIsOpen:function(){return a},toggleSaveConfirmationDialog:function(){return i}});const r=(0,n(46776).createSlice)({name:"dialogState",initialState:{confirmationDialogIsOpen:!1},reducers:{toggleSaveConfirmationDialog:t=>{t.confirmationDialogIsOpen=!t.confirmationDialogIsOpen}}}),{toggleSaveConfirmationDialog:i}=r.actions,a=t=>t.dialog.confirmationDialogIsOpen;e.default=r.reducer}}]);
}catch(e){WRMCB(e)};